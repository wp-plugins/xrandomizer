ace.define("ace/keyboard/vim",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/dom","ace/lib/oop","ace/lib/keys","ace/lib/event","ace/search","ace/lib/useragent","ace/search_highlight","ace/commands/multi_select_commands","ace/multi_select"],function(ct,M,c4){function J(){function aa(af){return typeof af!="object"?af+"":"line" in af?af.line+":"+af.ch:"anchor" in af?aa(af.anchor)+"->"+aa(af.head):Array.isArray(af)?"["+af.map(function(ag){return aa(ag)})+"]":JSON.stringify(af)}var ad="";for(var ac=0;ac<arguments.length;ac++){var ae=arguments[ac],ab=aa(ae);ad+=ab+"  "}console.log(ad)}function O(aa){return{row:aa.line,column:aa.ch}}function c0(aa){return new cm(aa.row,aa.column)}function dm(ad){var aa=ad.keyCode;if(R.indexOf(aa)!=-1){return}var ac=ad.ctrlKey||ad.metaKey,ae=cq.keyNames[aa];ae=q[ae]||ae;var ab="";ad.ctrlKey&&(ab+="C-"),ad.altKey&&(ab+="A-");if(dj&&ad.metaKey||!ac&&ad.shiftKey&&ae.length<2){return}return ad.shiftKey&&!/^[A-Za-z]$/.test(ae)&&(ab+="S-"),ae.length==1&&(ae=ae.toLowerCase()),ab+=ae,ab.length>1&&(ab="<"+ab+">"),ab}function D(aa,ab){var ac=dm(ab);if(!ac){return}cq.signal(aa,"vim-keypress",ac),cq.Vim.handleKey(aa,ac,"user")&&cq.e_stop(ab)}function n(ad,ab){var ac=ab.charCode||ab.keyCode;if(ab.ctrlKey||ab.metaKey||ab.altKey||ab.shiftKey&&ac<32){return}var aa=String.fromCharCode(ac);cq.signal(ad,"vim-keypress",aa),cq.Vim.handleKey(ad,aa,"user")&&cq.e_stop(ab)}function cV(aa){aa.setOption("disableInput",!0),aa.setOption("showCursorWhenSelecting",!1),cq.signal(aa,"vim-mode-change",{mode:"normal"}),aa.on("cursorActivity",cP),dB(aa),cq.on(aa.getInputField(),"paste",C(aa)),aa.on("keypress",n),aa.on("keydown",D)}function A(aa){aa.setOption("disableInput",!1),aa.off("cursorActivity",cP),cq.off(aa.getInputField(),"paste",C(aa)),aa.state.vim=null,aa.off("keypress",n),aa.off("keydown",D)}function l(aa,ab){this==cq.keyMap.vim&&cq.rmClass(aa.getWrapperElement(),"cm-fat-cursor"),(!ab||ab.attach!=E)&&A(aa,!1)}function E(aa,ab){this==cq.keyMap.vim&&cq.addClass(aa.getWrapperElement(),"cm-fat-cursor"),(!ab||ab.attach!=E)&&cV(aa)}function C(aa){var ab=aa.state.vim;return ab.onPasteFn||(ab.onPasteFn=function(){ab.insertMode||(aa.setCursor(a7(aa.getCursor(),0,1)),cn.enterInsertMode(aa,{},ab))}),ab.onPasteFn}function u(ad,ab){var ac=[];for(var aa=ad;aa<ad+ab;aa++){ac.push(String.fromCharCode(aa))}return ac}function de(aa,ab){return ab>=aa.firstLine()&&ab<=aa.lastLine()}function dp(aa){return/^[a-z]$/.test(aa)}function Z(aa){return"()[]{}".indexOf(aa)!=-1}function du(aa){return cj.test(aa)}function ca(aa){return/^[A-Z]$/.test(aa)}function ds(aa){return/^\s*$/.test(aa)}function a5(aa,ab){for(var ac=0;ac<ab.length;ac++){if(ab[ac]==aa){return !0}}return !1}function z(ad,ab,ac){if(ab===undefined){throw Error("defaultValue is required")}ac||(ac="string");var aa=ad;typeof ad=="string"?aa={type:ac,defaultValue:ab}:ad=aa.name,x[ad]=aa,dc(ad,ab)}function dc(ad,ab,ac){var aa=x[ad];if(!aa){throw Error("Unknown option: "+ad)}if(aa.type=="boolean"){if(ab&&ab!==!0){throw Error("Invalid argument: "+ad+"="+ab)}ab!==!1&&(ab=!0)}aa.value=ab,aa.set&&aa.set(ab,ac)}function t(aa){var ab=x[aa];if(!ab){throw Error("Unknown option: "+aa)}return ab.value}function e(){this.latestRegister=undefined,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=undefined,this.lastInsertModeChanges=cf()}function dB(aa){return aa.state.vim||(aa.state.vim={inputState:new c2,lastEditInputState:undefined,lastEditActionCommand:undefined,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:!1,insertModeRepeat:undefined,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{}}),aa.state.vim}function c8(){F={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:undefined,jumpList:cc(),macroModeState:new e,lastChararacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new df({}),searchHistoryController:new an({}),exCommandHistoryController:new an({})};for(var aa in x){var ab=x[aa];ab.value=ab.defaultValue}}function c2(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null}function by(aa,ab){aa.state.vim.inputState=new c2,cq.signal(aa,"vim-command-done",ab)}function bx(aa,ab,ac){this.clear(),this.keyBuffer=[aa||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!ab,this.blockwise=!!ac}function df(aa){this.registers=aa,this.unnamedRegister=aa['"']=new bx,aa["."]=new bx,aa[":"]=new bx,aa["/"]=new bx}function an(){this.historyBuffer=[],this.iterator,this.initialPrefix=null}function a8(ad,ab){var ac=[];for(var aa=0;aa<ab;aa++){ac.push(ad)}return ac}function br(ad,aa,ac){var ae=Math.min(Math.max(ad.firstLine(),aa.line),ad.lastLine()),ab=dC(ad,ae)-1;ab=ac?ab+1:ab;var af=Math.min(Math.max(0,aa.ch),ab);return cm(ae,af)}function dx(aa){var ab={};for(var ac in aa){aa.hasOwnProperty(ac)&&(ab[ac]=aa[ac])}return ab}function a7(aa,ab,ac){return typeof ab=="object"&&(ac=ab.ch,ab=ab.line),cm(aa.line+ab,aa.ch+ac)}function ce(aa,ab){return{line:ab.line-aa.line,ch:ab.line-aa.line}}function cR(ae,ab,ag,ai){var af,aa=[],ah=[];for(var ac=0;ac<ab.length;ac++){var ad=ab[ac];if(ag=="insert"&&ad.context!="insert"||ad.context&&ad.context!=ag||ai.operator&&ad.type=="action"||!(af=cy(ae,ad.keys))){continue}af=="partial"&&aa.push(ad),af=="full"&&ah.push(ad)}return{partial:aa.length&&aa,full:ah.length&&ah}}function cy(ad,aa){if(aa.slice(-11)=="<character>"){var ac=aa.length-11,ae=ad.slice(0,ac),ab=aa.slice(0,ac);return ae==ab&&ad.length>ac?"full":ab.indexOf(ae)==0?"partial":!1}return ad==aa?"full":aa.indexOf(ad)==0?"partial":!1}function U(aa){var ab=/^.*(<[\w\-]+>)$/.exec(aa),ac=ab?ab[1]:aa.slice(-1);if(ac.length>1){switch(ac){case"<CR>":ac="\n";break;case"<Space>":ac=" ";break;default:}}return ac}function S(aa,ab,ac){return function(){for(var ad=0;ad<ac;ad++){ab(aa)}}}function bm(aa){return cm(aa.line,aa.ch)}function dt(aa,ab){return aa.ch==ab.ch&&aa.line==ab.line}function dG(aa,ab){return aa.line<ab.line?!0:aa.line==ab.line&&aa.ch<ab.ch?!0:!1}function cZ(aa,ab){return arguments.length>2&&(ab=cZ.apply(undefined,Array.prototype.slice.call(arguments,1))),dG(aa,ab)?aa:ab}function b(aa,ab){return arguments.length>2&&(ab=b.apply(undefined,Array.prototype.slice.call(arguments,1))),dG(aa,ab)?ab:aa}function dh(ad,aa,ac){var ae=dG(ad,aa),ab=dG(aa,ac);return ae&&ab}function dC(aa,ab){return aa.getLine(ab).length}function c9(aa){return aa.split("").reverse().join("")}function c5(aa){return aa.trim?aa.trim():aa.replace(/^\s+|\s+$/g,"")}function cg(aa){return aa.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function bz(ad,aa,ac){var ae=dC(ad,aa),ab=(new Array(ac-ae+1)).join(" ");ad.setCursor(cm(aa,ae)),ad.replaceRange(ab,ad.getCursor())}function bu(ad,ah){var am=[],ar=ad.listSelections(),aj=bm(ad.clipPos(ah)),ae=!dt(ah,aj),ao=ad.getCursor("head"),aq=cw(ar,ao),aa=dt(ar[aq].head,ar[aq].anchor),af=ar.length-1,ak=af-aq>aq?af:0,ab=ar[ak].anchor,ai=Math.min(ab.line,aj.line),ap=Math.max(ab.line,aj.line),ac=ab.ch,au=aj.ch,al=ar[ak].head.ch-ac,ag=au-ac;al>0&&ag<=0?(ac++,ae||au--):al<0&&ag>=0?(ac--,aa||au++):al<0&&ag==-1&&(ac--,au++);for(var aw=ai;aw<=ap;aw++){var av={anchor:new cm(aw,ac),head:new cm(aw,au)};am.push(av)}return aq=aj.line==ap?am.length-1:0,ad.setSelections(am),ah.ch=au,ab.ch=ac,ab}function dy(ad,aa,ac){var ae=[];for(var ab=0;ab<ac;ab++){var af=a7(aa,ab,0);ae.push({anchor:af,head:af})}ad.setSelections(ae,0)}function cw(ad,aa,ac){for(var ae=0;ae<ad.length;ae++){var ab=ac!="head"&&dt(ad[ae].anchor,aa),af=ac!="anchor"&&dt(ad[ae].head,aa);if(ab||af){return ae}}return -1}function c1(ad,aa){var ac=aa.lastSelection,ae=function(){var ai=ad.listSelections(),af=ai[0],ag=ai[ai.length-1],aj=dG(af.anchor,af.head)?af.anchor:af.head,ah=dG(ag.anchor,ag.head)?ag.head:ag.anchor;return[aj,ah]},ab=function(){var ah=ad.getCursor(),ap=ad.getCursor(),ak=ac.visualBlock;if(ak){var af=ak.width,am=ak.height;ap=cm(ah.line+am,ah.ch+af);var ai=[];for(var ar=ah.line;ar<ap.line;ar++){var ag=cm(ar,ah.ch),al=cm(ar,ap.ch),au={anchor:ag,head:al};ai.push(au)}ad.setSelections(ai)}else{var aj=ac.anchorMark.find(),ao=ac.headMark.find(),av=ao.line-aj.line,aq=ao.ch-aj.ch;ap={line:ap.line+av,ch:av?ap.ch:aq+ap.ch},ac.visualLine&&(ah=cm(ah.line,0),ap=cm(ap.line,dC(ad,ap.line))),ad.setSelection(ah,ap)}return[ah,ap]};return aa.visualMode?ae():ab()}function da(ad,ab){var ac=ab.sel.anchor,aa=ab.sel.head;ab.lastPastedText&&(aa=ad.posFromIndex(ad.indexFromPos(ac)+ab.lastPastedText.length),ab.lastPastedText=null),ab.lastSelection={anchorMark:ad.setBookmark(ac),headMark:ad.setBookmark(aa),anchor:bm(ac),head:bm(aa),visualMode:ab.visualMode,visualLine:ab.visualLine,visualBlock:ab.visualBlock}}function a(ae,aa,ac){var af=ae.state.vim.sel,ab=af.head,ag=af.anchor,ad;return dG(ac,aa)&&(ad=ac,ac=aa,aa=ad),dG(ab,ag)?(ab=cZ(aa,ab),ag=b(ag,ac)):(ag=cZ(aa,ag),ab=b(ab,ac),ab=a7(ab,0,-1),ab.ch==-1&&ab.line!=ae.firstLine()&&(ab=cm(ab.line-1,dC(ae,ab.line-1)))),[ag,ab]}function cU(ad,aa,ac){var ae=ad.state.vim;aa=aa||ae.sel;var ac=ac||ae.visualLine?"line":ae.visualBlock?"block":"char",ab=r(ad,aa,ac);ad.setSelections(ab.ranges,ab.primary),k(ad)}function r(ae,ap,af,ak){var al=bm(ap.head),ao=bm(ap.anchor);if(af=="char"){var ag=!ak&&!dG(ap.head,ap.anchor)?1:0,aq=dG(ap.head,ap.anchor)?1:0;return al=a7(ap.head,0,ag),ao=a7(ap.anchor,0,aq),{ranges:[{anchor:ao,head:al}],primary:0}}if(af=="line"){if(!dG(ap.head,ap.anchor)){ao.ch=0;var aa=ae.lastLine();al.line>aa&&(al.line=aa),al.ch=dC(ae,al.line)}else{al.ch=0,ao.ch=dC(ae,ao.line)}return{ranges:[{anchor:ao,head:al}],primary:0}}if(af=="block"){var ai=Math.min(ao.line,al.line),am=Math.min(ao.ch,al.ch),ac=Math.max(ao.line,al.line),aj=Math.max(ao.ch,al.ch)+1,ah=ac-ai+1,ad=al.line==ai?0:ah-1,ar=[];for(var ab=0;ab<ah;ab++){ar.push({anchor:cm(ai+ab,am),head:cm(ai+ab,aj)})}return{ranges:ar,primary:ad}}}function o(aa){var ab=aa.getCursor("head");return aa.getSelection().length==1&&(ab=cZ(ab,aa.getCursor("anchor"))),ab}function a1(aa,ab){var ac=aa.state.vim;ab!==!1&&aa.setCursor(br(aa,ac.sel.head)),da(aa,ac),ac.visualMode=!1,ac.visualLine=!1,ac.visualBlock=!1,cq.signal(aa,"vim-mode-change",{mode:"normal"}),ac.fakeCursor&&ac.fakeCursor.clear()}function bt(ad,aa,ac){var ae=ad.getRange(aa,ac);if(/\n\s*$/.test(ae)){var ab=ae.split("\n");ab.pop();var af;for(var af=ab.pop();ab.length>0&&af&&ds(af);af=ab.pop()){ac.line--,ac.ch=0}af?(ac.line--,ac.ch=dC(ad,ac.line)):ac.ch=0}}function cr(aa,ab,ac){ab.ch=0,ac.ch=0,ac.line++}function dg(aa){if(!aa){return 0}var ab=aa.search(/\S/);return ab==-1?aa.length:ab}function c7(ad,av,am,aq,ai){var ar=o(ad),ao=ad.getLine(ar.line),ak=ar.ch,aa=ao.substring(ak),ae;ai?ae=aa.search(/\w/):ae=aa.search(/\S/);if(ae==-1){return null}ak+=ae,aa=ao.substring(ak);var aj=ao.substring(0,ak),ab;aq?ab=/^\S+/:/\w/.test(ao.charAt(ak))?ab=/^\w+/:ab=/^[^\w\s]+/;var ah=ab.exec(aa),ap=ak,ac=ak+ah[0].length,au=c9(aj),al=ab.exec(au);al&&(ap-=al[0].length);if(av){var af=ao.substring(ac),ax=af.match(/^\s*/)[0].length;if(ax>0){ac+=ax}else{var aw=au.length-ap,ag=au.substring(aw),ay=ag.match(/^\s*/)[0].length;ap-=ay}}return{start:cm(ar.line,ap),end:cm(ar.line,ac)}}function bl(aa,ab,ac){dt(ab,ac)||F.jumpList.add(aa,ab,ac)}function cp(aa,ab){F.lastChararacterSearch.increment=aa,F.lastChararacterSearch.forward=ab.forward,F.lastChararacterSearch.selectedCharacter=ab.selectedCharacter}function dk(am,ab,ag,al){var ac=bm(am.getCursor()),aa=ag?1:-1,ah=ag?am.lineCount():-1,ad=ac.ch,ae=ac.line,ao=am.getLine(ae),af={lineText:ao,nextCh:ao.charAt(ad),lastCh:null,index:ad,symb:al,reverseSymb:(ag?{")":"(","}":"{"}:{"(":")","{":"}"})[al],forward:ag,depth:0,curMoveThrough:!1},aj=at[al];if(!aj){return ac}var ap=g[aj].init,ai=g[aj].isComplete;ap&&ap(af);while(ae!==ah&&ab){af.index+=aa,af.nextCh=af.lineText.charAt(af.index);if(!af.nextCh){ae+=aa,af.lineText=am.getLine(ae)||"";if(aa>0){af.index=0}else{var ak=af.lineText.length;af.index=ak>0?ak-1:0}af.nextCh=af.lineText.charAt(af.index)}ai(af)&&(ac.line=ae,ac.ch=af.index,ab--)}return af.nextCh||af.curMoveThrough?cm(ae,af.index):ac}function c(am,ab,ag,al,ac){var aa=ab.line,ah=ab.ch,ad=am.getLine(aa),ae=ag?1:-1,ao=al?G:p;if(ac&&ad==""){aa+=ae,ad=am.getLine(aa);if(!de(am,aa)){return null}ah=ag?0:ad.length}for(;;){if(ac&&ad==""){return{from:0,to:0,line:aa}}var af=ae>0?ad.length:-1,aj=af,ap=af;while(ah!=af){var ai=!1;for(var ak=0;ak<ao.length&&!ai;++ak){if(ao[ak].test(ad.charAt(ah))){aj=ah;while(ah!=af&&ao[ak].test(ad.charAt(ah))){ah+=ae}ap=ah,ai=aj!=ap;if(aj==ab.ch&&aa==ab.line&&ap==aj+ae){continue}return{from:Math.min(aj,ap+1),to:Math.max(aj,ap),line:aa}}}ai||(ah+=ae)}aa+=ae;if(!de(am,aa)){return null}ad=am.getLine(aa),ah=ae>0?0:ad.length}throw new Error("The impossible happened.")}function dz(am,ab,ag,al,ac,aa){var ah=bm(ab),ad=[];(al&&!ac||!al&&ac)&&ag++;var ae=!al||!ac;for(var ao=0;ao<ag;ao++){var af=c(am,ab,al,aa,ae);if(!af){var aj=dC(am,am.lastLine());ad.push(al?{line:am.lastLine(),from:aj,to:aj}:{line:0,from:0,to:0});break}ad.push(af),ab=cm(af.line,al?af.to-1:af.from)}var ap=ad.length!=ag,ai=ad[0],ak=ad.pop();return al&&!ac?(!ap&&(ai.from!=ah.ch||ai.line!=ah.line)&&(ak=ad.pop()),cm(ak.line,ak.from)):al&&ac?cm(ak.line,ak.to-1):!al&&ac?(!ap&&(ai.to!=ah.ch||ai.line!=ah.line)&&(ak=ad.pop()),cm(ak.line,ak.to)):cm(ak.line,ak.from)}function v(ae,ab,ag,ai){var af=ae.getCursor(),aa=af.ch,ah;for(var ac=0;ac<ab;ac++){var ad=ae.getLine(af.line);ah=cz(aa,ad,ai,ag,!0);if(ah==-1){return null}aa=ah}return cm(ae.getCursor().line,ah)}function h(aa,ab){var ac=aa.getCursor().line;return br(aa,cm(ac,ab-1))}function dn(ad,ab,ac,aa){if(!a5(ac,w)){return}ab.marks[ac]&&ab.marks[ac].clear(),ab.marks[ac]=ad.setBookmark(aa)}function cz(ad,aa,ac,ae,ab){var af;return ae?(af=aa.indexOf(ac,ad+1),af!=-1&&!ab&&(af-=1)):(af=aa.lastIndexOf(ac,ad-1),af!=-1&&!ab&&(af+=1)),af}function dH(ac,ak,ag,ai){var ae=ak,aj,ah,al={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/}[ag],aa={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{"}[ag],ad=ac.getLine(ae.line).charAt(ae.ch),af=ad===aa?1:0;aj=ac.scanForBracket(cm(ae.line,ae.ch+af),-1,null,{bracketRegex:al}),ah=ac.scanForBracket(cm(ae.line,ae.ch+af),1,null,{bracketRegex:al});if(!aj||!ah){return{start:ae,end:ae}}aj=aj.pos,ah=ah.pos;if(aj.line==ah.line&&aj.ch>ah.ch||aj.line>ah.line){var ab=aj;aj=ah,ah=ab}return ai?ah.ch+=1:aj.ch+=1,{start:aj,end:ah}}function bv(ac,ak,ag,ai){var ae=bm(ak),aj=ac.getLine(ae.line),ah=aj.split(""),al,aa,ad,af,ab=ah.indexOf(ag);ae.ch<ab?ae.ch=ab:ab<ae.ch&&ah[ae.ch]==ag&&(aa=ae.ch,--ae.ch);if(ah[ae.ch]==ag&&!aa){al=ae.ch+1}else{for(ad=ae.ch;ad>-1&&!al;ad--){ah[ad]==ag&&(al=ad+1)}}if(al&&!aa){for(ad=al,af=ah.length;ad<af&&!aa;ad++){ah[ad]==ag&&(aa=ad)}}return !al||!aa?{start:ae,end:ae}:(ai&&(--al,++aa),{start:cm(ae.line,al),end:cm(ae.line,aa)})}function db(){}function W(aa){var ab=aa.state.vim;return ab.searchState_||(ab.searchState_=new db)}function K(ad,aa,ac,ae,ab){ad.openDialog?ad.openDialog(aa,ae,{bottom:!0,value:ab.value,onKeyDown:ab.onKeyDown,onKeyUp:ab.onKeyUp}):ae(prompt(ac,""))}function dD(ad){var ab=a3(ad)||[];if(!ab.length){return[]}var ac=[];if(ab[0]!==0){return}for(var aa=0;aa<ab.length;aa++){typeof ab[aa]=="number"&&ac.push(ad.substring(ab[aa]+1,ab[aa+1]))}return ac}function a3(ad){var aa=!1,ac=[];for(var ae=0;ae<ad.length;ae++){var ab=ad.charAt(ae);!aa&&ab=="/"&&ac.push(ae),aa=!aa&&ab=="\\"}return ac}function bn(ae){var ab="|(){",ag="}",ai=!1,af=[];for(var aa=-1;aa<ae.length;aa++){var ah=ae.charAt(aa)||"",ac=ae.charAt(aa+1)||"",ad=ac&&ab.indexOf(ac)!=-1;ai?((ah!=="\\"||!ad)&&af.push(ah),ai=!1):ah==="\\"?(ai=!0,ac&&ag.indexOf(ac)!=-1&&(ad=!0),(!ad||ac==="\\")&&af.push(ah)):(af.push(ah),ad&&ac!=="\\"&&af.push("\\"))}return af.join("")}function ch(ad){var aa=!1,ac=[];for(var ae=-1;ae<ad.length;ae++){var ab=ad.charAt(ae)||"",af=ad.charAt(ae+1)||"";aa?(ac.push(ab),aa=!1):ab==="\\"?(aa=!0,du(af)||af==="$"?ac.push("$"):af!=="/"&&af!=="\\"&&ac.push("\\")):(ab==="$"&&ac.push("$"),ac.push(ab),af==="/"&&ac.push("\\"))}return ac.join("")}function bo(aa){var ab=new cq.StringStream(aa),ac=[];while(!ab.eol()){while(ab.peek()&&ab.peek()!="\\"){ac.push(ab.next())}ab.match("\\/",!0)?ac.push("/"):ab.match("\\\\",!0)?ac.push("\\"):ac.push(ab.next())}return ac.join("")}function dv(ae,ab,ag){var ai=F.registerController.getRegister("/");ai.setText(ae);if(ae instanceof RegExp){return ae}var af=a3(ae),aa,ah;if(!af.length){aa=ae}else{aa=ae.substring(0,af[0]);var ac=ae.substring(af[0]);ah=ac.indexOf("i")!=-1}if(!aa){return null}t("pcre")||(aa=bn(aa)),ag&&(ab=/^[^A-Z]*$/.test(aa));var ad=new RegExp(aa,ab||ah?"i":undefined);return ad}function a2(aa,ab){aa.openNotification?aa.openNotification('<span style="color: red">'+ab+"</span>",{bottom:!0,duration:5000}):alert(ab)}function dl(aa,ab){var ac="";return aa&&(ac+='<span style="font-family: monospace">'+aa+"</span>"),ac+='<input type="text"/> <span style="color: #888">',ab&&(ac+='<span style="color: #888">',ac+=ab,ac+="</span>"),ac}function cu(ad,ab){var ac=(ab.prefix||"")+" "+(ab.desc||""),aa=dl(ab.prefix,ab.desc);K(ad,aa,ac,ab.onClose,ab)}function Q(ad,aa){if(ad instanceof RegExp&&aa instanceof RegExp){var ac=["global","multiline","ignoreCase","source"];for(var ae=0;ae<ac.length;ae++){var ab=ac[ae];if(ad[ab]!==aa[ab]){return !1}}return !0}return !1}function P(ad,aa,ac,ae){if(!aa){return}var ab=W(ad),af=dv(aa,!!ac,!!ae);if(!af){return}return dq(ad,af),Q(af,ab.getQuery())?af:(ab.setQuery(af),af)}function a4(aa){if(aa.source.charAt(0)=="^"){var ab=!0}return{token:function(ac){if(ab&&!ac.sol()){ac.skipToEnd();return}var ad=ac.match(aa,!1);if(ad){if(ad[0].length==0){return ac.next(),"searching"}if(!ac.sol()){ac.backUp(1);if(!aa.exec(ac.next()+ad[0])){return ac.next(),null}}return ac.match(aa),"searching"}while(!ac.eol()){ac.next();if(ac.match(aa,!1)){break}}},query:aa}}function dq(aa,ab){var ac=W(aa).getOverlay();if(!ac||ab!=ac.query){ac&&aa.removeOverlay(ac),ac=a4(ab),aa.addOverlay(ac),W(aa).setOverlay(ac)}}function dE(ad,ab,ac,aa){return aa===undefined&&(aa=1),ad.operation(function(){var ag=ad.getCursor(),af=ad.getSearchCursor(ac,ag);for(var ae=0;ae<aa;ae++){var ah=af.find(ab);ae==0&&ah&&dt(af.from(),ag)&&(ah=af.find(ab));if(!ah){af=ad.getSearchCursor(ac,ab?cm(ad.lastLine()):cm(ad.firstLine(),0));if(!af.find(ab)){return}}}return af.from()})}function cW(aa){aa.removeOverlay(W(aa).getOverlay()),W(aa).setOverlay(null)}function dJ(aa,ab,ac){return typeof aa!="number"&&(aa=aa.line),ab instanceof Array?a5(aa,ab):ac?aa>=ab&&aa<=ac:aa==ab}function dd(aa){var ab=aa.ace.renderer;return{top:ab.getFirstFullyVisibleRow(),bottom:ab.getLastFullyVisibleRow()}}function dI(aj,aq,ag,al,ao,ap,ah,aa,ad){function ae(){aj.operation(function(){while(!ak){am(),ai()}ac()})}function am(){var ar=aj.getRange(ap.from(),ap.to()),au=ar.replace(ah,aa);ap.replace(au)}function ai(){var ar;while(ar=ap.findNext()&&dJ(ap.from(),al,ao)){if(!ag&&ab&&ap.from().line==ab.line){continue}aj.scrollIntoView(ap.from(),30),aj.setSelection(ap.from(),ap.to()),ab=ap.from(),ak=!1;return}ak=!0}function ac(ar){ar&&ar(),aj.focus();if(ab){aj.setCursor(ab);var au=aj.state.vim;au.exMode=!1,au.lastHPos=au.lastHSPos=ab.ch}ad&&ad()}function af(ax,au,av){cq.e_stop(ax);var ar=cq.keyName(ax);switch(ar){case"Y":am(),ai();break;case"N":ai();break;case"A":var aw=ad;ad=undefined,aj.operation(ae),ad=aw;break;case"L":am();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":ac(av)}return ak&&ac(av),!0}aj.state.vim.exMode=!0;var ak=!1,ab=ap.from();ai();if(ak){a2(aj,"No matches for "+ah.source);return}if(!aq){ae(),ad&&ad();return}cu(aj,{prefix:"replace with <strong>"+aa+"</strong> (y/n/a/q/l)",onKeyDown:af})}function bq(ae){var ab=ae.state.vim,ah=F.macroModeState,aj=F.registerController.getRegister("."),ag=ah.isPlaying,aa=ah.lastInsertModeChanges,ai=[];if(!ag){var ac=aa.inVisualBlock?ab.lastSelection.visualBlock.height:1,ad=aa.changes,ai=[],af=0;while(af<ad.length){ai.push(ad[af]),ad[af] instanceof a0?af++:af+=ac}aa.changes=ai,ae.off("change",bw),cq.off(ae.getInputField(),"keydown",bs)}!ag&&ab.insertModeRepeat>1&&(ci(ae,ab,ab.insertModeRepeat-1,!0),ab.lastEditInputState.repeatOverride=ab.insertModeRepeat),delete ab.insertModeRepeat,ab.insertMode=!1,ae.setCursor(ae.getCursor().line,ae.getCursor().ch-1),ae.setOption("keyMap","vim"),ae.setOption("disableInput",!0),ae.toggleOverwrite(!1),aj.setText(aa.changes.join("")),cq.signal(ae,"vim-mode-change",{mode:"normal"}),ah.isRecording&&cX(ah)}function dw(ac,ak,ag,ai){var ae=F.registerController.getRegister(ai),aj=ae.keyBuffer,ah=0;ag.isPlaying=!0,ag.replaySearchQueries=ae.searchQueries.slice(0);for(var al=0;al<aj.length;al++){var aa=aj[al],ad,af;while(aa){ad=/<\w+-.+?>|<\w+>|./.exec(aa),af=ad[0],aa=aa.substring(ad.index+af.length),cq.Vim.handleKey(ac,af,"macro");if(ak.insertMode){var ab=ae.insertModeChanges[ah++].changes;F.macroModeState.lastInsertModeChanges.changes=ab,B(ac,ab,1),bq(ac)}}}ag.isPlaying=!1}function cs(ad,ab){if(ad.isPlaying){return}var ac=ad.latestRegister,aa=F.registerController.getRegister(ac);aa&&aa.pushText(ab)}function cX(aa){if(aa.isPlaying){return}var ab=aa.latestRegister,ac=F.registerController.getRegister(ab);ac&&ac.pushInsertModeChanges(aa.lastInsertModeChanges)}function y(ad,ab){if(ad.isPlaying){return}var ac=ad.latestRegister,aa=F.registerController.getRegister(ac);aa&&aa.pushSearchQuery(ab)}function bw(ad,aa){var ac=F.macroModeState,ae=ac.lastInsertModeChanges;if(!ac.isPlaying){while(aa){ae.expectCursorActivityForChange=!0;if(aa.origin=="+input"||aa.origin=="paste"||aa.origin===undefined){var ab=aa.text.join("\n");ae.changes.push(ab)}aa=aa.next}}}function cP(ad){var ab=ad.state.vim;if(ab.insertMode){var ac=F.macroModeState;if(ac.isPlaying){return}var aa=ac.lastInsertModeChanges;aa.expectCursorActivityForChange?aa.expectCursorActivityForChange=!1:aa.changes=[]}else{ad.curOp.isVimOp||j(ad,ab)}ab.visualMode&&k(ad)}function k(ad){var ab=ad.state.vim,ac=bm(ab.sel.head),aa=a7(ac,0,1);ab.fakeCursor&&ab.fakeCursor.clear(),ab.fakeCursor=ad.markText(ac,aa,{className:"cm-animate-fat-cursor"})}function j(ad,aa){var ac=ad.getCursor("anchor"),ae=ad.getCursor("head");aa.visualMode&&dt(ae,ac)&&dC(ad,ae.line)>ae.ch?a1(ad,!1):!aa.visualMode&&!aa.insertMode&&ad.somethingSelected()&&(aa.visualMode=!0,aa.visualLine=!1,cq.signal(ad,"vim-mode-change",{mode:"visual"}));if(aa.visualMode){var ab=dG(ae,ac)?0:-1,af=dG(ae,ac)?-1:0;ae=a7(ae,0,ab),ac=a7(ac,0,af),aa.sel={anchor:ac,head:ae},dn(ad,aa,"<",cZ(ae,ac)),dn(ad,aa,">",b(ae,ac))}else{aa.insertMode||(aa.lastHPos=ad.getCursor().ch)}}function a0(aa){this.keyName=aa}function bs(ad){function aa(){return ac.changes.push(new a0(ae)),!0}var ab=F.macroModeState,ac=ab.lastInsertModeChanges,ae=cq.keyName(ad);(ae.indexOf("Delete")!=-1||ae.indexOf("Backspace")!=-1)&&cq.lookupKey(ae,"vim-insert",aa)}function ci(ae,ab,ah,aj){function ac(){aa?Y.processAction(ae,ab,ab.lastEditActionCommand):Y.evalInput(ae,ab)}function ad(al){if(ag.lastInsertModeChanges.changes.length>0){al=ab.lastEditActionCommand?al:1;var ak=ag.lastInsertModeChanges;B(ae,ak.changes,al)}}var ag=F.macroModeState;ag.isPlaying=!0;var aa=!!ab.lastEditActionCommand,ai=ab.inputState;ab.inputState=ab.lastEditInputState;if(aa&&ab.lastEditActionCommand.interlaceInsertRepeat){for(var af=0;af<ah;af++){ac(),ad(1)}}else{aj||ac(),ad(ah)}ab.inputState=ai,ab.insertMode&&!aj&&bq(ae),ag.isPlaying=!1}function B(aa,ai,af){function aj(ao){return typeof ao=="string"?cq.commands[ao](aa):ao(aa),!0}var ad=aa.getCursor("head"),ah=F.macroModeState.lastInsertModeChanges.inVisualBlock;if(ah){var ag=aa.state.vim,ak=ag.lastSelection,al=ce(ak.anchor,ak.head);dy(aa,ad,al.line+1),af=aa.listSelections().length,aa.setCursor(ad)}for(var ab=0;ab<af;ab++){ah&&aa.setCursor(a7(ad,ab,0));for(var ae=0;ae<ai.length;ae++){var am=ai[ae];if(am instanceof a0){cq.lookupKey(am.keyName,"vim-insert",aj)}else{var ac=aa.getCursor();aa.replaceRange(am,ac,ac)}}}ah&&aa.setCursor(a7(ad,0,1))}function dm(ad,ab,ac){ab.length>1&&ab[0]=="n"&&(ab=ab.replace("numpad","")),ab=q[ab]||ab;var aa="";return ac.ctrlKey&&(aa+="C-"),ac.altKey&&(aa+="A-"),ac.shiftKey&&(aa+="S-"),aa+=ab,aa.length>1&&(aa="<"+aa+">"),aa}function a6(aa){var ab=new aa.constructor;return Object.keys(aa).forEach(function(ac){var ad=aa[ac];Array.isArray(ad)?ad=ad.slice():ad&&typeof ad=="object"&&ad.constructor!=Object&&(ad=a6(ad)),ab[ac]=ad}),aa.sel&&(ab.sel={head:aa.sel.head&&bm(aa.sel.head),anchor:aa.sel.anchor&&bm(aa.sel.anchor)}),ab}function cl(ae,aa,ac){var af=!1,ab=T.maybeInitVimState_(ae),ag=ab.visualBlock||ab.wasInVisualBlock;ab.wasInVisualBlock&&!ae.ace.inMultiSelectMode?ab.wasInVisualBlock=!1:ae.ace.inMultiSelectMode&&ab.visualBlock&&(ab.wasInVisualBlock=!0);if(aa=="<Esc>"&&!ab.insertMode&&!ab.visualMode&&ae.ace.inMultiSelectMode){ae.ace.exitMultiSelectMode()}else{if(ag||!ae.ace.inMultiSelectMode||ae.ace.inVirtualSelectionMode){af=T.handleKey(ae,aa,ac)}else{var ad=a6(ab);ae.operation(function(){ae.ace.forEachSelection(function(){var aj=ae.ace.selection;ae.state.vim.lastHPos=aj.$desiredColumn==null?aj.lead.column:aj.$desiredColumn;var ai=ae.getCursor("head"),ak=ae.getCursor("anchor"),al=dG(ai,ak)?0:-1,ah=dG(ai,ak)?-1:0;ai=a7(ai,0,al),ak=a7(ak,0,ah),ae.state.vim.sel.head=ai,ae.state.vim.sel.anchor=ak,af=cT(ae,aa,ac),aj.$desiredColumn=ae.state.vim.lastHPos==-1?null:ae.state.vim.lastHPos,ae.virtualSelectionMode()&&(ae.state.vim=a6(ad))}),ae.curOp.cursorActivity&&!af&&(ae.curOp.cursorActivity=!1)},!0)}}return af}function di(aa,ab){ab.off("beforeEndOperation",di);var ac=ab.state.cm.vimCmd;ac&&ab.execCommand(ac.exec?ac:ac.name,ac.args),ab.curOp=ab.prevOp}var cQ=ct("../range").Range,L=ct("../lib/event_emitter").EventEmitter,c6=ct("../lib/dom"),N=ct("../lib/oop"),ck=ct("../lib/keys"),cv=ct("../lib/event"),cY=ct("../search").Search,co=ct("../lib/useragent"),cO=ct("../search_highlight").SearchHighlight,H=ct("../commands/multi_select_commands");ct("../multi_select");var cq=function(aa){this.ace=aa,this.state={},this.marks={},this.$uid=0,this.onChange=this.onChange.bind(this),this.onSelectionChange=this.onSelectionChange.bind(this),this.onBeforeEndOperation=this.onBeforeEndOperation.bind(this),this.ace.on("change",this.onChange),this.ace.on("changeSelection",this.onSelectionChange),this.ace.on("beforeEndOperation",this.onBeforeEndOperation)};cq.Pos=function(aa,ab){if(!(this instanceof cm)){return new cm(aa,ab)}this.line=aa,this.ch=ab},cq.defineOption=function(aa,ab,ac){},cq.commands={redo:function(aa){aa.ace.redo()},undo:function(aa){aa.ace.undo()},newlineAndIndent:function(aa){aa.ace.insert("\n")}},cq.keyMap={},cq.addClass=cq.rmClass=cq.e_stop=function(){},cq.keyName=function(aa){if(aa.key){return aa.key}var ab=ck[aa.keyCode]||"";return ab.length==1&&(ab=ab.toUpperCase()),ab=cv.getModifierString(aa).replace(/(^|-)\w/g,function(ac){return ac.toUpperCase()})+ab,ab},cq.keyMap["default"]=function(aa){return function(ab){var ac=ab.ace.commands.commandKeyBinding[aa.toLowerCase()];return ac&&ab.ace.execCommand(ac)!==!1}},cq.lookupKey=function d(ad,aa,ac){typeof aa=="string"&&(aa=cq.keyMap[aa]);var ae=typeof aa=="function"?aa(ad):aa[ad];if(ae===!1){return"nothing"}if(ae==="..."){return"multi"}if(ae!=null&&ac(ae)){return"handled"}if(aa.fallthrough){if(!Array.isArray(aa.fallthrough)){return d(ad,aa.fallthrough,ac)}for(var ab=0;ab<aa.fallthrough.length;ab++){var af=d(ad,aa.fallthrough[ab],ac);if(af){return af}}}},cq.signal=function(aa,ab,ac){return aa._signal(ab,ac)},cq.on=cv.addListener,cq.off=cv.removeListener,function(){N.implement(cq.prototype,L),this.destroy=function(){this.ace.off("change",this.onChange),this.ace.off("changeSelection",this.onSelectionChange),this.ace.off("beforeEndOperation",this.onBeforeEndOperation),this.removeOverlay()},this.virtualSelectionMode=function(){return this.ace.inVirtualSelectionMode&&this.ace.selection.index},this.onChange=function(ad){var af=ad.data;ad={start:af.range.start,end:af.range.end,action:af.action,lines:af.lines||[af.text]};if(ad.action[0]=="i"){var ac={text:ad.lines},ae=this.curOp=this.curOp||{};ae.changeHandlers||(ae.changeHandlers=this._eventRegistry.change&&this._eventRegistry.change.slice());if(this.virtualSelectionMode()){return}ae.lastChange?ae.lastChange.next=ae.lastChange=ac:ae.lastChange=ae.change=ac}this.$updateMarkers(ad)},this.onSelectionChange=function(){var ac=this.curOp=this.curOp||{};ac.cursorActivityHandlers||(ac.cursorActivityHandlers=this._eventRegistry.cursorActivity&&this._eventRegistry.cursorActivity.slice()),this.curOp.cursorActivity=!0,this.ace.inMultiSelectMode&&this.ace.keyBinding.removeKeyboardHandler(H.keyboardHandler)},this.operation=function(ad,af){if(!af&&this.curOp||af&&this.curOp&&this.curOp.force){return ad()}(af||!this.ace.curOp)&&this.curOp&&this.onBeforeEndOperation();if(!this.ace.curOp){var ac=this.ace.prevOp;this.ace.startOperation({command:{name:"vim",scrollIntoView:"cursor"}})}var ae=this.curOp=this.curOp||{};this.curOp.force=af;var ag=ad();return this.ace.curOp&&this.ace.curOp.command.name=="vim"&&(this.ace.endOperation(),!ae.cursorActivity&&!ae.lastChange&&ac&&(this.ace.prevOp=ac)),(af||!this.ace.curOp)&&this.curOp&&this.onBeforeEndOperation(),ag},this.onBeforeEndOperation=function(){var ac=this.curOp;ac&&(ac.change&&this.signal("change",ac.change,ac),ac&&ac.cursorActivity&&this.signal("cursorActivity",null,ac),this.curOp=null)},this.signal=function(ad,af,ac){var ae=ac?ac[ad+"Handlers"]:(this._eventRegistry||{})[ad];if(!ae){return}ae=ae.slice();for(var ag=0;ag<ae.length;ag++){ae[ag](this,af)}},this.firstLine=function(){return 0},this.lastLine=function(){return this.ace.session.getLength()-1},this.lineCount=function(){return this.ace.session.getLength()},this.setCursor=function(ac,ad){typeof ac=="object"&&(ad=ac.ch,ac=ac.line),this.ace.inVirtualSelectionMode||this.ace.exitMultiSelectMode(),this.ace.selection.moveTo(ac,ad)},this.getCursor=function(ad){var ae=this.ace.selection,ac=ad=="anchor"?ae.isEmpty()?ae.lead:ae.anchor:ad=="head"||!ad?ae.lead:ae.getRange()[ad];return c0(ac)},this.listSelections=function(ac){var ad=this.ace.multiSelect.rangeList.ranges;return !ad.length||this.ace.inVirtualSelectionMode?[{anchor:this.getCursor("anchor"),head:this.getCursor("head")}]:ad.map(function(ae){return{anchor:this.clipPos(c0(ae.cursor==ae.end?ae.start:ae.end)),head:this.clipPos(c0(ae.cursor))}},this)},this.setSelections=function(ae,ah){var ac=this.ace.multiSelect,af=ae.map(function(aj){var al=O(aj.anchor),am=O(aj.head),ak=cQ.comparePoints(al,am)<0?new cQ.fromPoints(al,am):new cQ.fromPoints(am,al);return ak.cursor=cQ.comparePoints(ak.start,am)?ak.end:ak.start,ak});if(this.ace.inVirtualSelectionMode){this.ace.selection.fromOrientedRange(af[0]);return}ah?af[ah]&&af.push(af.splice(ah,1)[0]):af=af.reverse(),ac.toSingleRange(af[0].clone());var ag=this.ace.session;for(var ad=0;ad<af.length;ad++){var ai=ag.$clipRangeToDocument(af[ad]);ac.addRange(ai)}},this.setSelection=function(ad,af,ac){var ae=this.ace.selection;ae.moveTo(ad.line,ad.ch),ae.selectTo(af.line,af.ch),ac&&ac.origin=="*mouse"&&this.onBeforeEndOperation()},this.somethingSelected=function(ac){return !this.ace.selection.isEmpty()},this.clipPos=function(ac){var ad=this.ace.session.$clipPositionToDocument(ac.line,ac.ch);return c0(ad)},this.markText=function(ac){return{clear:function(){},find:function(){}}},this.$updateMarkers=function(ag){var ad=ag.action=="insert",aj=ag.start,al=ag.end,ac=(al.row-aj.row)*(ad?1:-1),ak=(al.column-aj.column)*(ad?1:-1);ad&&(al=aj);for(var ae in this.marks){var af=this.marks[ae],ah=cQ.comparePoints(af,aj);if(ah<0){continue}if(ah===0&&ad){if(af.bias!=1){af.bias==-1;continue}ah=1}var ai=ad?ah:cQ.comparePoints(af,al);if(ai>0){af.row+=ac,af.column+=af.row==al.row?ak:0;continue}!ad&&ai<=0&&(af.row=aj.row,af.column=aj.column,ai===0&&(af.bias=1))}};var aa=function(ad,af,ac,ae){this.cm=ad,this.id=af,this.row=ac,this.column=ae,ad.marks[this.id]=this};aa.prototype.clear=function(){delete this.cm.marks[this.id]},aa.prototype.find=function(){return c0(this)},this.setBookmark=function(ae,ac){var ad=new aa(this,this.$uid++,ae.line,ae.ch);if(!ac||!ac.insertLeft){ad.$insertRight=!0}return this.marks[ad.id]=ad,ad},this.moveH=function(ad,ae){if(ae=="char"){var ac=this.ace.selection;ac.clearSelection(),ac.moveCursorBy(0,ad)}},this.findPosV=function(ad,ag,ac,ae){if(ac=="line"){var ah=this.ace.session.documentToScreenPosition(ad.line,ad.ch);ae!=null&&(ah.column=ae),ah.row+=ag,ah.row=Math.min(Math.max(0,ah.row),this.ace.session.getScreenLength()-1);var af=this.ace.session.screenToDocumentPosition(ah.row,ah.column);return c0(af)}},this.charCoords=function(ae,ah){if(ah=="div"||!ah){var ac=this.ace.session.documentToScreenPosition(ae.line,ae.ch);return{left:ac.column,top:ac.row}}if(ah=="local"){var af=this.ace.renderer,ac=this.ace.session.documentToScreenPosition(ae.line,ae.ch),ai=af.layerConfig.lineHeight,ag=af.layerConfig.characterWidth,ad=ai*ac.row;return{left:ac.column*ag,top:ad,bottom:ad+ai}}},this.coordsChar=function(ad,ag){var ac=this.ace.renderer;if(ag=="local"){var ae=Math.max(0,Math.floor(ad.top/ac.lineHeight)),ah=Math.max(0,Math.floor(ad.left/ac.characterWidth)),af=ac.session.screenToDocumentPosition(ae,ah);return c0(af)}if(ag=="div"){throw"not implemented"}},this.openDialog=function(){},this.getSearchCursor=function(ag,ad,ai){var ak=!1,ah=!1;ag instanceof RegExp&&!ag.global&&(ak=!ag.ignoreCase,ag=ag.source,ah=!0);var ac=new cY;ad.ch==undefined&&(ad.ch=Number.MAX_VALUE);var aj={row:ad.line,column:ad.ch},ae=this,af=null;return{findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(am){ac.setOptions({needle:ag,caseSensitive:ak,wrap:!1,backwards:am,regExp:ah,start:af||aj});var al=ac.find(ae.ace.session);return al&&al.isEmpty()&&ae.getLine(al.start.row).length==al.start.column&&(ac.$options.start=al,al=ac.find(ae.ace.session)),af=al,af},from:function(){return af&&c0(af.start)},to:function(){return af&&c0(af.end)},replace:function(al){af&&(af.end=ae.ace.session.doc.replace(af,al))}}},this.scrollTo=function(ad,af){var ac=this.ace.renderer,ae=ac.layerConfig,ag=ae.maxHeight;ag-=(ac.$size.scrollerHeight-ac.lineHeight)*ac.$scrollPastEnd,af!=null&&this.ace.session.setScrollTop(Math.max(0,Math.min(af,ag))),ad!=null&&this.ace.session.setScrollLeft(Math.max(0,Math.min(ad,ae.width)))},this.scrollInfo=function(){return 0},this.scrollIntoView=function(ac,ad){ac&&this.ace.renderer.scrollCursorIntoView(O(ac),null,ad)},this.getLine=function(ac){return this.ace.session.getLine(ac)},this.getRange=function(ac,ad){return this.ace.session.getTextRange(new cQ(ac.line,ac.ch,ad.line,ad.ch))},this.replaceRange=function(ad,ae,ac){return ac||(ac=ae),this.ace.session.replace(new cQ(ae.line,ae.ch,ac.line,ac.ch),ad)},this.replaceSelections=function(ad){var af=this.ace.selection;if(this.ace.inVirtualSelectionMode){this.ace.session.replace(af.getRange(),ad[0]||"");return}af.inVirtualSelectionMode=!0;var ac=af.rangeList.ranges;ac.length||(ac=[this.ace.multiSelect.getRange()]);for(var ae=ac.length;ae--;){this.ace.session.replace(ac[ae],ad[ae]||"")}af.inVirtualSelectionMode=!1},this.getSelection=function(){return this.ace.getSelectedText()},this.getSelections=function(){return this.listSelections().map(function(ac){return this.getRange(ac.anchor,ac.head)},this)},this.getInputField=function(){return this.ace.textInput.getElement()},this.getWrapperElement=function(){return this.ace.containter};var ab={indentWithTabs:"useSoftTabs",indentUnit:"tabSize",firstLineNumber:"firstLineNumber"};this.setOption=function(ad,ac){this.state[ad]=ac;switch(ad){case"indentWithTabs":ad=ab[ad],ac=!ac;break;default:ad=ab[ad]}ad&&this.ace.setOption(ad,ac)},this.getOption=function(ad,ac){var ae=ab[ad];ae&&(ac=this.ace.getOption(ae));switch(ad){case"indentWithTabs":return ad=ab[ad],!ac}return ae?ac:this.state[ad]},this.toggleOverwrite=function(ac){return this.state.overwrite=ac,this.ace.setOverwrite(ac)},this.addOverlay=function(ad){if(!this.$searchHighlight||!this.$searchHighlight.session){var af=new cO(null,"ace_highlight-marker","text"),ac=this.ace.session.addDynamicMarker(af);af.id=ac.id,af.session=this.ace.session,af.destroy=function(ag){af.session.off("change",af.updateOnChange),af.session.off("changeEditor",af.destroy),af.session.removeMarker(af.id),af.session=null},af.updateOnChange=function(ah){ah=ah.data.range;var ag=ah.start.row;ag==ah.end.row?af.cache[ag]=undefined:af.cache.splice(ag,af.cache.length)},af.session.on("changeEditor",af.destroy),af.session.on("change",af.updateOnChange)}var ae=new RegExp(ad.query.source,"gmi");console.log(ae),this.$searchHighlight=ad.highlight=af,this.$searchHighlight.setRegexp(ae),this.ace.renderer.updateBackMarkers()},this.removeOverlay=function(ac){this.$searchHighlight&&this.$searchHighlight.session&&this.$searchHighlight.destroy()},this.getScrollInfo=function(){var ac=this.ace.renderer,ad=ac.layerConfig;return{left:ac.scrollLeft,top:ac.scrollTop,height:ad.maxHeight,width:ad.width,clientHeight:ad.height,clientWidth:ad.width}},this.getValue=function(){return this.ace.getValue()},this.setValue=function(ac){return this.ace.setValue(ac)},this.getTokenTypeAt=function(ac){var ad=this.ace.session.getTokenAt(ac.line,ac.ch);return ad&&/comment|string/.test(ad.type)?"string":""},this.findMatchingBracket=function(ac){var ad=this.ace.session.findMatchingBracket(O(ac));return{to:ad&&c0(ad)}},this.indentLine=function(ac,ad){ad===!0?this.ace.session.indentRows(ac,ac,"	"):ad===!1&&this.ace.session.outdentRows(new cQ(ac,0,ac,0))},this.indexFromPos=function(ac){return this.ace.session.doc.positionToIndex(O(ac))},this.posFromIndex=function(ac){return c0(this.ace.session.doc.indexToPosition(ac))},this.focus=function(ac){return this.ace.focus()},this.blur=function(ac){return this.ace.blur()},this.defaultTextHeight=function(ac){return this.ace.renderer.layerConfig.lineHeight},this.scanForBracket=function(ad,ag,ac,ae){var ah=ae.bracketRegex.source;if(ag==1){var af=this.ace.session.$findClosingBracket(ah.slice(1,2),O(ad),/paren|text/)}else{var af=this.ace.session.$findOpeningBracket(ah.slice(-2,-1),{row:ad.line,column:ad.ch+1},/paren|text/)}return af&&{pos:c0(af)}},this.refresh=function(){return this.ace.resize(!0)}}.call(cq.prototype);var cx=cq.StringStream=function(aa,ab){this.pos=this.start=0,this.string=aa,this.tabSize=ab||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};cx.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(aa){var ab=this.string.charAt(this.pos);if(typeof aa=="string"){var ac=ab==aa}else{var ac=ab&&(aa.test?aa.test(ab):aa(ab))}if(ac){return ++this.pos,ab}},eatWhile:function(aa){var ab=this.pos;while(this.eat(aa)){}return this.pos>ab},eatSpace:function(){var aa=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>aa},skipToEnd:function(){this.pos=this.string.length},skipTo:function(aa){var ab=this.string.indexOf(aa,this.pos);if(ab>-1){return this.pos=ab,!0}},backUp:function(aa){this.pos-=aa},column:function(){throw"not implemented"},indentation:function(){throw"not implemented"},match:function(ad,aa,ac){if(typeof ad!="string"){var af=this.string.slice(this.pos).match(ad);return af&&af.index>0?null:(af&&aa!==!1&&(this.pos+=af[0].length),af)}var ae=function(ag){return ac?ag.toLowerCase():ag},ab=this.string.substr(this.pos,ad.length);if(ae(ab)==ae(ad)){return aa!==!1&&(this.pos+=ad.length),!0}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(aa,ab){this.lineStart+=aa;try{return ab()}finally{this.lineStart-=aa}}},cq.defineExtension=function(aa,ab){cq.prototype[aa]=ab},c6.importCssString(".normal-mode .ace_cursor{  border: 0!important;  background-color: red;  opacity: 0.5;}.ace_dialog {  position: absolute;  left: 0; right: 0;  background: white;  z-index: 15;  padding: .1em .8em;  overflow: hidden;  color: #333;}.ace_dialog-top {  border-bottom: 1px solid #eee;  top: 0;}.ace_dialog-bottom {  border-top: 1px solid #eee;  bottom: 0;}.ace_dialog input {  border: none;  outline: none;  background: transparent;  width: 20em;  color: inherit;  font-family: monospace;}","vimMode"),function(){function aa(ad,af,ac){var ae=ad.ace.container,ag;return ag=ae.appendChild(document.createElement("div")),ac?ag.className="ace_dialog ace_dialog-bottom":ag.className="ace_dialog ace_dialog-top",typeof af=="string"?ag.innerHTML=af:ag.appendChild(af),ag}function ab(ac,ad){ac.state.currentNotificationClose&&ac.state.currentNotificationClose(),ac.state.currentNotificationClose=ad}cq.defineExtension("openDialog",function(ai,ak,ag){function ae(al){if(typeof al=="string"){af.value=al}else{if(aj){return}aj=!0,ac.parentNode.removeChild(ac),ad.focus(),ag.onClose&&ag.onClose(ac)}}if(this.virtualSelectionMode()){return}ag||(ag={}),ab(this,null);var ac=aa(this,ai,ag.bottom),aj=!1,ad=this,af=ac.getElementsByTagName("input")[0],ah;if(af){ag.value&&(af.value=ag.value,af.select()),ag.onInput&&cq.on(af,"input",function(al){ag.onInput(al,af.value,ae)}),ag.onKeyUp&&cq.on(af,"keyup",function(al){ag.onKeyUp(al,af.value,ae)}),cq.on(af,"keydown",function(al){if(ag&&ag.onKeyDown&&ag.onKeyDown(al,af.value,ae)){return}if(al.keyCode==27||ag.closeOnEnter!==!1&&al.keyCode==13){af.blur(),cq.e_stop(al),ae()}al.keyCode==13&&ak(af.value)}),ag.closeOnBlur!==!1&&cq.on(af,"blur",ae),af.focus()}else{if(ah=ac.getElementsByTagName("button")[0]){cq.on(ah,"click",function(){ae(),ad.focus()}),ag.closeOnBlur!==!1&&cq.on(ah,"blur",ae),ah.focus()}}return ae}),cq.defineExtension("openNotification",function(ac,ae){function ai(){if(af){return}af=!0,clearTimeout(ad),ag.parentNode.removeChild(ag)}if(this.virtualSelectionMode()){return}ab(this,ai);var ag=aa(this,ac,ae&&ae.bottom),af=!1,ad,ah=ae&&typeof ae.duration!="undefined"?ae.duration:5000;return cq.on(ag,"click",function(aj){cq.e_preventDefault(aj),ai()}),ah&&(ad=setTimeout(ai,ah)),ai})}();var V=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"xi",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"dcc",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],cm=cq.Pos,R=[16,17,18,91],q={Enter:"CR",Backspace:"BS",Delete:"Del"},dj=/Mac/.test(navigator.platform),T=function(){return dr};cq.defineOption("vimMode",!1,function(aa,ab,ac){ab&&aa.getOption("keyMap")!="vim"?aa.setOption("keyMap","vim"):!ab&&ac!=cq.Init&&/^vim/.test(aa.getOption("keyMap"))&&aa.setOption("keyMap","default")});var cj=/[\d]/,p=[/\w/,/[^\w\s]/],G=[/\S/],m=u(65,26),cS=u(97,26),s=u(48,10),w=[].concat(m,cS,s,["<",">"]),I=[].concat(m,cS,s,["-",'"',".",":","/"]),x={},cc=function(){function ag(ai,ao,aj){function ak(aq){var ap=++aa%ae,ar=ab[ap];ar&&ar.clear(),ab[ap]=ai.setBookmark(aq)}var am=aa%ae,ah=ab[am];if(ah){var al=ah.find();al&&!dt(al,ao)&&ak(ao)}else{ak(ao)}ak(aj),ac=aa,af=aa-ae+1,af<0&&(af=0)}function ad(ai,am){aa+=am,aa>ac?aa=ac:aa<af&&(aa=af);var aj=ab[(ae+aa)%ae];if(aj&&!aj.find()){var ak=am>0?1:-1,ah,al=ai.getCursor();do{aa+=ak,aj=ab[(ae+aa)%ae];if(aj&&(ah=aj.find())&&!dt(al,ah)){break}}while(aa<ac&&aa>af)}return aj}var ae=100,aa=-1,ac=0,af=0,ab=new Array(ae);return{cachedCursor:undefined,add:ag,move:ad}},cf=function(aa){return aa?{changes:aa.changes,expectCursorActivityForChange:aa.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};e.prototype={exitMacroRecordMode:function(){var aa=F.macroModeState;aa.onRecordingDone&&aa.onRecordingDone(),aa.onRecordingDone=undefined,aa.isRecording=!1},enterMacroRecordMode:function(aa,ab){var ac=F.registerController.getRegister(ab);ac&&(ac.clear(),this.latestRegister=ab,aa.openDialog&&(this.onRecordingDone=aa.openDialog("(recording)["+ab+"]",null,{bottom:!0})),this.isRecording=!0)}};var F,cd,dr={buildKeyMap:function(){},getRegisterController:function(){return F.registerController},resetVimGlobalState_:c8,getVimGlobalState_:function(){return F},maybeInitVimState_:dB,InsertModeKey:a0,map:function(aa,ab,ac){cb.map(aa,ab,ac)},unmap:function(aa,ab){cb.unmap(aa,ab)},setOption:dc,getOption:t,defineOption:z,defineEx:function(aa,ab,ac){if(aa.indexOf(ab)!==0){throw new Error('(Vim.defineEx) "'+ab+'" is not a prefix of "'+aa+'", command not registered')}c3[aa]=ac,cb.commandMap_[ab]={name:aa,shortName:ab,type:"api"}},handleKey:function(ae,ab,ag){function af(){var aj=F.macroModeState;if(aj.isRecording){if(ab=="q"){return aj.exitMacroRecordMode(),by(ae),!0}ag!="mapping"&&cs(aj,ab)}}function aa(){if(ab=="<Esc>"){return by(ae),ai.visualMode?a1(ae):ai.insertMode&&bq(ae),!0}}function ah(ak){var aj;while(ak){aj=/<\w+-.+?>|<\w+>|./.exec(ak),ab=aj[0],ak=ak.substring(aj.index+ab.length),cq.Vim.handleKey(ae,ab,"mapping")}}function ac(){if(aa()){return !0}var ak=ai.inputState.keyBuffer=ai.inputState.keyBuffer+ab,ao=ab.length==1,ap=Y.matchCommand(ak,V,ai.inputState,"insert");while(ak.length>1&&ap.type!="full"){var ak=ai.inputState.keyBuffer=ak.slice(1),aj=Y.matchCommand(ak,V,ai.inputState,"insert");aj.type!="none"&&(ap=aj)}if(ap.type=="none"){return by(ae),!1}if(ap.type=="partial"){return cd&&window.clearTimeout(cd),cd=window.setTimeout(function(){ai.insertMode&&ai.inputState.keyBuffer&&by(ae)},t("insertModeEscKeysTimeout")),!ao}cd&&window.clearTimeout(cd);if(ao){var al=ae.getCursor();ae.replaceRange("",a7(al,0,-(ak.length-1)),al,"+input")}by(ae);var am=ap.command;return am.type=="keyToKey"?ah(am.toKeys):Y.processCommand(ae,ai,am),!0}function ad(){if(af()||aa()){return !0}var am=ai.inputState.keyBuffer=ai.inputState.keyBuffer+ab;if(/^[1-9]\d*$/.test(am)){return !0}var aj=/^(\d*)(.*)$/.exec(am);if(!aj){return by(ae),!1}var ak=ai.visualMode?"visual":"normal",ao=Y.matchCommand(aj[2]||aj[1],V,ai.inputState,ak);if(ao.type=="none"){return by(ae),!1}if(ao.type=="partial"){return !0}ai.inputState.keyBuffer="";var al=ao.command,aj=/^(\d*)(.*)$/.exec(am);return aj[1]&&aj[1]!="0"&&ai.inputState.pushRepeatDigit(aj[1]),al.type=="keyToKey"?ah(al.toKeys):Y.processCommand(ae,ai,al),!0}var ai=dB(ae);return ae.operation(function(){ae.curOp.isVimOp=!0;try{return ai.insertMode?ac():ad()}catch(aj){throw ae.state.vim=undefined,dB(ae),aj}})},handleEx:function(aa,ab){cb.processCommand(aa,ab)}};c2.prototype.pushRepeatDigit=function(aa){this.operator?this.motionRepeat=this.motionRepeat.concat(aa):this.prefixRepeat=this.prefixRepeat.concat(aa)},c2.prototype.getRepeat=function(){var aa=0;if(this.prefixRepeat.length>0||this.motionRepeat.length>0){aa=1,this.prefixRepeat.length>0&&(aa*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(aa*=parseInt(this.motionRepeat.join(""),10))}return aa},bx.prototype={setText:function(aa,ab,ac){this.keyBuffer=[aa||""],this.linewise=!!ab,this.blockwise=!!ac},pushText:function(aa,ab){ab&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0),this.keyBuffer.push(aa)},pushInsertModeChanges:function(aa){this.insertModeChanges.push(cf(aa))},pushSearchQuery:function(aa){this.searchQueries.push(aa)},clear:function(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1},toString:function(){return this.keyBuffer.join("")}},df.prototype={pushText:function(ae,aa,ac,af,ab){af&&ac.charAt(0)=="\n"&&(ac=ac.slice(1)+"\n"),af&&ac.charAt(ac.length-1)!=="\n"&&(ac+="\n");var ag=this.isValidRegister(ae)?this.getRegister(ae):null;if(!ag){switch(aa){case"yank":this.registers[0]=new bx(ac,af,ab);break;case"delete":case"change":ac.indexOf("\n")==-1?this.registers["-"]=new bx(ac,af):(this.shiftNumericRegisters_(),this.registers[1]=new bx(ac,af))}this.unnamedRegister.setText(ac,af,ab);return}var ad=ca(ae);ad?ag.pushText(ac,af):ag.setText(ac,af,ab),this.unnamedRegister.setText(ag.toString(),af)},getRegister:function(aa){return this.isValidRegister(aa)?(aa=aa.toLowerCase(),this.registers[aa]||(this.registers[aa]=new bx),this.registers[aa]):this.unnamedRegister},isValidRegister:function(aa){return aa&&a5(aa,I)},shiftNumericRegisters_:function(){for(var aa=9;aa>=2;aa--){this.registers[aa]=this.getRegister(""+(aa-1))}}},an.prototype={nextMatch:function(ae,aa){var ac=this.historyBuffer,af=aa?-1:1;this.initialPrefix===null&&(this.initialPrefix=ae);for(var ab=this.iterator+af;aa?ab>=0:ab<ac.length;ab+=af){var ag=ac[ab];for(var ad=0;ad<=ag.length;ad++){if(this.initialPrefix==ag.substring(0,ad)){return this.iterator=ab,ag}}}if(ab>=ac.length){return this.iterator=ac.length,this.initialPrefix}if(ab<0){return ae}},pushInput:function(aa){var ab=this.historyBuffer.indexOf(aa);ab>-1&&this.historyBuffer.splice(ab,1),aa.length&&this.historyBuffer.push(aa)},reset:function(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}};var Y={matchCommand:function(ae,ah,ac,af){var aa=cR(ae,ah,af,ac);if(!aa.full&&!aa.partial){return{type:"none"}}if(!aa.full&&aa.partial){return{type:"partial"}}var ag;for(var ad=0;ad<aa.full.length;ad++){var ab=aa.full[ad];ag||(ag=ab)}return ag.keys.slice(-11)=="<character>"&&(ac.selectedCharacter=U(ae)),{type:"full",command:ag}},processCommand:function(aa,ab,ac){ab.inputState.repeatOverride=ac.repeatOverride;switch(ac.type){case"motion":this.processMotion(aa,ab,ac);break;case"operator":this.processOperator(aa,ab,ac);break;case"operatorMotion":this.processOperatorMotion(aa,ab,ac);break;case"action":this.processAction(aa,ab,ac);break;case"search":this.processSearch(aa,ab,ac),by(aa);break;case"ex":case"keyToEx":this.processEx(aa,ab,ac),by(aa);break;default:}},processMotion:function(aa,ab,ac){ab.inputState.motion=ac.motion,ab.inputState.motionArgs=dx(ac.motionArgs),this.evalInput(aa,ab)},processOperator:function(ad,ab,ac){var aa=ab.inputState;if(aa.operator){if(aa.operator==ac.operator){aa.motion="expandToLine",aa.motionArgs={linewise:!0},this.evalInput(ad,ab);return}by(ad)}aa.operator=ac.operator,aa.operatorArgs=dx(ac.operatorArgs),ab.visualMode&&this.evalInput(ad,ab)},processOperatorMotion:function(ad,aa,ac){var ae=aa.visualMode,ab=dx(ac.operatorMotionArgs);ab&&ae&&ab.visualLine&&(aa.visualLine=!0),this.processOperator(ad,aa,ac),ae||this.processMotion(ad,aa,ac)},processAction:function(ae,aa,ac){var af=aa.inputState,ab=af.getRepeat(),ag=!!ab,ad=dx(ac.actionArgs)||{};af.selectedCharacter&&(ad.selectedCharacter=af.selectedCharacter),ac.operator&&this.processOperator(ae,aa,ac),ac.motion&&this.processMotion(ae,aa,ac),(ac.motion||ac.operator)&&this.evalInput(ae,aa),ad.repeat=ab||1,ad.repeatIsExplicit=ag,ad.registerName=af.registerName,by(ae),aa.lastMotion=null,ac.isEdit&&this.recordLastEdit(aa,af,ac),cn[ac.action](ae,ad,aa)},processSearch:function(aj,aq,ag){function ad(av,ar,aw){F.searchHistoryController.pushInput(av),F.searchHistoryController.reset();try{P(aj,av,ar,aw)}catch(au){a2(aj,"Invalid regex: "+av);return}Y.processMotion(aj,aq,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:ag.searchArgs.toJumplist}})}function ak(ar){aj.scrollTo(aa.left,aa.top),ad(ar,!0,!0);var au=F.macroModeState;au.isRecording&&y(au,ar)}function ac(aw,ar,ax){var av=cq.keyName(aw),au;av=="Up"||av=="Down"?(au=av=="Up"?!0:!1,ar=F.searchHistoryController.nextMatch(ar,au)||"",ax(ar)):av!="Left"&&av!="Right"&&av!="Ctrl"&&av!="Alt"&&av!="Shift"&&F.searchHistoryController.reset();var ay;try{ay=P(aj,ar,!0,!0)}catch(aw){}ay?aj.scrollIntoView(dE(aj,!al,ay),30):(cW(aj),aj.scrollTo(aa.left,aa.top))}function ae(aw,au,av){var ar=cq.keyName(aw);if(ar=="Esc"||ar=="Ctrl-C"||ar=="Ctrl-["){F.searchHistoryController.pushInput(au),F.searchHistoryController.reset(),P(aj,ah),cW(aj),aj.scrollTo(aa.left,aa.top),cq.e_stop(aw),av(),aj.focus()}}if(!aj.getSearchCursor){return}var al=ag.searchArgs.forward,ao=ag.searchArgs.wholeWordOnly;W(aj).setReversed(!al);var ap=al?"/":"?",ah=W(aj).getQuery(),aa=aj.getScrollInfo();switch(ag.searchArgs.querySrc){case"prompt":var am=F.macroModeState;if(am.isPlaying){var ai=am.replaySearchQueries.shift();ad(ai,!0,!1)}else{cu(aj,{onClose:ak,prefix:ap,desc:cN,onKeyUp:ac,onKeyDown:ae})}break;case"wordUnderCursor":var ab=c7(aj,!1,!0,!1,!0),af=!0;ab||(ab=c7(aj,!1,!0,!1,!1),af=!1);if(!ab){return}var ai=aj.getLine(ab.start.line).substring(ab.start.ch,ab.end.ch);af&&ao?ai="\\b"+ai+"\\b":ai=cg(ai),F.jumpList.cachedCursor=aj.getCursor(),aj.setCursor(ab.start),ad(ai,!0,!1)}},processEx:function(ad,aa,ac){function ae(af){F.exCommandHistoryController.pushInput(af),F.exCommandHistoryController.reset(),cb.processCommand(ad,af)}function ab(ai,af,ag){var aj=cq.keyName(ai),ah;if(aj=="Esc"||aj=="Ctrl-C"||aj=="Ctrl-["){F.exCommandHistoryController.pushInput(af),F.exCommandHistoryController.reset(),cq.e_stop(ai),ag(),ad.focus()}aj=="Up"||aj=="Down"?(ah=aj=="Up"?!0:!1,af=F.exCommandHistoryController.nextMatch(af,ah)||"",ag(af)):aj!="Left"&&aj!="Right"&&aj!="Ctrl"&&aj!="Alt"&&aj!="Shift"&&F.exCommandHistoryController.reset()}ac.type=="keyToEx"?cb.processCommand(ad,ac.exArgs.input):aa.visualMode?cu(ad,{onClose:ae,prefix:":",value:"'<,'>",onKeyDown:ab}):cu(ad,{onClose:ae,prefix:":",onKeyDown:ab})},evalInput:function(aI,ak){var ac=ak.inputState,ag=ac.motion,aa=ac.motionArgs||{},aj=ac.operator,ad=ac.operatorArgs||{},ap=ac.registerName,aD=ak.sel,ah=bm(ak.visualMode?aD.head:aI.getCursor("head")),aA=bm(ak.visualMode?aD.anchor:aI.getCursor("anchor")),aE=bm(ah),aF=bm(aA),ae,aG,aq;aj&&this.recordLastEdit(ak,ac),ac.repeatOverride!==undefined?aq=ac.repeatOverride:aq=ac.getRepeat();if(aq>0&&aa.explicitRepeat){aa.repeatIsExplicit=!0}else{if(aa.noRepeat||!aa.explicitRepeat&&aq===0){aq=1,aa.repeatIsExplicit=!1}}ac.selectedCharacter&&(aa.selectedCharacter=ad.selectedCharacter=ac.selectedCharacter),aa.repeat=aq,by(aI);if(ag){var ab=dF[ag](aI,ah,aa,ak);ak.lastMotion=dF[ag];if(!ab){return}if(aa.toJumplist){var al=F.jumpList,av=al.cachedCursor;av?(bl(aI,av,ab),delete al.cachedCursor):bl(aI,ah,ab)}ab instanceof Array?(aG=ab[0],ae=ab[1]):ae=ab,ae||(ae=bm(ah)),ak.visualMode?(ae=br(aI,ae,!0),aG&&(aG=br(aI,aG,!0)),aG=aG||aF,aD.anchor=aG,aD.head=ae,cU(aI),dn(aI,ak,"<",dG(aG,ae)?aG:ae),dn(aI,ak,">",dG(aG,ae)?ae:aG)):aj||(ae=br(aI,ae),aI.setCursor(ae.line,ae.ch))}if(aj){if(ad.lastSel){aG=aF;var ar=ad.lastSel,ao=Math.abs(ar.head.line-ar.anchor.line),aB=Math.abs(ar.head.ch-ar.anchor.ch);ar.visualLine?ae=cm(aF.line+ao,aF.ch):ar.visualBlock?ae=cm(aF.line+ao,aF.ch+aB):ar.head.line==ar.anchor.line?ae=cm(aF.line,aF.ch+aB):ae=cm(aF.line+ao,aF.ch),ak.visualMode=!0,ak.visualLine=ar.visualLine,ak.visualBlock=ar.visualBlock,aD=ak.sel={anchor:aG,head:ae},cU(aI)}else{ak.visualMode&&(ad.lastSel={anchor:bm(aD.anchor),head:bm(aD.head),visualBlock:ak.visualBlock,visualLine:ak.visualLine})}var au,aH,am,ai,ax;if(ak.visualMode){au=cZ(aD.head,aD.anchor),aH=b(aD.head,aD.anchor),am=ak.visualLine||ad.linewise,ai=ak.visualBlock?"block":am?"line":"char",ax=r(aI,{anchor:au,head:aH},ai);if(am){var aw=ax.ranges;if(ai=="block"){for(var af=0;af<aw.length;af++){aw[af].head.ch=dC(aI,aw[af].head.line)}}else{ai=="line"&&(aw[0].head=cm(aw[0].head.line+1,0))}}}else{au=bm(aG||aF),aH=bm(ae||aE);if(dG(aH,au)){var az=au;au=aH,aH=az}am=aa.linewise||ad.linewise,am?cr(aI,au,aH):aa.forward&&bt(aI,au,aH),ai="char";var ay=!aa.inclusive||am;ax=r(aI,{anchor:au,head:aH},ai,ay)}aI.setSelections(ax.ranges,ax.primary),ak.lastMotion=null,ad.repeat=aq,ad.registerName=ap,ad.linewise=am;var aC=bp[aj](aI,ad,ax.ranges,aF,ae);ak.visualMode&&a1(aI),aC&&aI.setCursor(aC)}},recordLastEdit:function(ad,ab,ac){var aa=F.macroModeState;if(aa.isPlaying){return}ad.lastEditInputState=ab,ad.lastEditActionCommand=ac,aa.lastInsertModeChanges.changes=[],aa.lastInsertModeChanges.expectCursorActivityForChange=!1}},dF={moveToTopLine:function(ad,ab,ac){var aa=dd(ad).top+ac.repeat-1;return cm(aa,dg(ad.getLine(aa)))},moveToMiddleLine:function(aa){var ab=dd(aa),ac=Math.floor((ab.top+ab.bottom)*0.5);return cm(ac,dg(aa.getLine(ac)))},moveToBottomLine:function(ad,ab,ac){var aa=dd(ad).bottom-ac.repeat+1;return cm(aa,dg(ad.getLine(aa)))},expandToLine:function(ad,ab,ac){var aa=ab;return cm(aa.line+ac.repeat-1,Infinity)},findNext:function(ad,aa,ac){var ae=W(ad),ab=ae.getQuery();if(!ab){return}var af=!ac.forward;return af=ae.isReversed()?!af:af,dq(ad,ab),dE(ad,af,ab,ac.repeat)},goToMark:function(ad,aa,ac,ae){var ab=ae.marks[ac.selectedCharacter];if(ab){var af=ab.find();return ac.linewise?{line:af.line,ch:dg(ad.getLine(af.line))}:af}return null},moveToOtherHighlightedEnd:function(ad,aa,ac,ae){if(ae.visualBlock&&ac.sameLine){var ab=ae.sel;return[br(ad,cm(ab.anchor.line,ab.head.ch)),br(ad,cm(ab.head.line,ab.anchor.ch))]}return[ae.sel.head,ae.sel.anchor]},jumpToMark:function(ac,ak,ag,ai){var ae=ak;for(var aj=0;aj<ag.repeat;aj++){var ah=ae;for(var al in ai.marks){if(!dp(al)){continue}var aa=ai.marks[al].find(),ad=ag.forward?dG(aa,ah):dG(ah,aa);if(ad){continue}if(ag.linewise&&aa.line==ah.line){continue}var af=dt(ah,ae),ab=ag.forward?dh(ah,aa,ae):dh(ae,aa,ah);if(af||ab){ae=aa}}}return ag.linewise&&(ae=cm(ae.line,dg(ac.getLine(ae.line)))),ae},moveByCharacters:function(ad,aa,ac){var ae=aa,ab=ac.repeat,af=ac.forward?ae.ch+ab:ae.ch-ab;return cm(ae.line,af)},moveByLines:function(ae,ab,ah,aj){var ag=ab,aa=ag.ch;switch(aj.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:aa=aj.lastHPos;break;default:aj.lastHPos=aa}var ai=ah.repeat+(ah.repeatOffset||0),ac=ah.forward?ag.line+ai:ag.line-ai,ad=ae.firstLine(),af=ae.lastLine();if(ac<ad&&ag.line==ad||ac>af&&ag.line==af){return}return ah.toFirstChar&&(aa=dg(ae.getLine(ac)),aj.lastHPos=aa),aj.lastHSPos=ae.charCoords(cm(ac,aa),"div").left,cm(ac,aa)},moveByDisplayLines:function(ae,ab,ah,aj){var ag=ab;switch(aj.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:aj.lastHSPos=ae.charCoords(ag,"div").left}var aa=ah.repeat,ai=ae.findPosV(ag,ah.forward?aa:-aa,"line",aj.lastHSPos);if(ai.hitSide){if(ah.forward){var ac=ae.charCoords(ai,"div"),ad={top:ac.top+8,left:aj.lastHSPos},ai=ae.coordsChar(ad,"div")}else{var af=ae.charCoords(cm(ae.firstLine(),0),"div");af.left=aj.lastHSPos,ai=ae.coordsChar(af,"div")}}return aj.lastHPos=ai.ch,ai},moveByPage:function(ad,aa,ac){var ae=aa,ab=ac.repeat;return ad.findPosV(ae,ac.forward?ab:-ab,"page")},moveByParagraph:function(ae,aa,ac){var af=aa.line,ab=ac.repeat,ag=ac.forward?1:-1;for(var ad=0;ad<ab;ad++){if(!ac.forward&&af===ae.firstLine()||ac.forward&&af==ae.lastLine()){break}af+=ag;while(af!==ae.firstLine()&&af!=ae.lastLine()&&ae.getLine(af)){af+=ag}}return cm(af,0)},moveByScroll:function(ae,ab,ag,ai){var af=ae.getScrollInfo(),aa=null,ah=ag.repeat;ah||(ah=af.clientHeight/(2*ae.defaultTextHeight()));var ac=ae.charCoords(ab,"local");ag.repeat=ah;var aa=dF.moveByDisplayLines(ae,ab,ag,ai);if(!aa){return null}var ad=ae.charCoords(aa,"local");return ae.scrollTo(null,af.top+ad.top-ac.top),aa},moveByWords:function(aa,ab,ac){return dz(aa,ab,ac.repeat,!!ac.forward,!!ac.wordEnd,!!ac.bigWord)},moveTillCharacter:function(ad,aa,ac){var ae=ac.repeat,ab=v(ad,ae,ac.forward,ac.selectedCharacter),af=ac.forward?-1:1;return cp(af,ac),ab?(ab.ch+=af,ab):null},moveToCharacter:function(ad,ab,ac){var aa=ac.repeat;return cp(0,ac),v(ad,aa,ac.forward,ac.selectedCharacter)||ab},moveToSymbol:function(ad,ab,ac){var aa=ac.repeat;return dk(ad,aa,ac.forward,ac.selectedCharacter)||ab},moveToColumn:function(ad,aa,ac,ae){var ab=ac.repeat;return ae.lastHPos=ab-1,ae.lastHSPos=ad.charCoords(aa,"div").left,h(ad,ab)},moveToEol:function(ae,aa,ac,af){var ab=aa;af.lastHPos=Infinity;var ag=cm(ab.line+ac.repeat-1,Infinity),ad=ae.clipPos(ag);return ad.ch--,af.lastHSPos=ae.charCoords(ad,"div").left,ag},moveToFirstNonWhiteSpaceCharacter:function(aa,ab){var ac=ab;return cm(ac.line,dg(aa.getLine(ac.line)))},moveToMatchedSymbol:function(ae,ab){var ag=ab,ai=ag.line,af=ag.ch,aa=ae.getLine(ai),ah;do{ah=aa.charAt(af++);if(ah&&Z(ah)){var ac=ae.getTokenTypeAt(cm(ai,af));if(ac!=="string"&&ac!=="comment"){break}}}while(ah);if(ah){var ad=ae.findMatchingBracket(cm(ai,af));return ad.to}return ag},moveToStartOfLine:function(aa,ab){return cm(ab.line,0)},moveToLineOrEdgeOfDocument:function(ad,ab,ac){var aa=ac.forward?ad.lastLine():ad.firstLine();return ac.repeatIsExplicit&&(aa=ac.repeat-ad.getOption("firstLineNumber")),cm(aa,dg(ad.getLine(aa)))},textObjectManipulation:function(ae,ah,ac){var af={"(":")",")":"(","{":"}","}":"{","[":"]","]":"["},aa={"'":!0,'"':!0},ag=ac.selectedCharacter;ag=="b"?ag="(":ag=="B"&&(ag="{");var ad=!ac.textObjectInner,ab;if(af[ag]){ab=dH(ae,ah,ag,ad)}else{if(aa[ag]){ab=bv(ae,ah,ag,ad)}else{if(ag==="W"){ab=c7(ae,ad,!0,!0)}else{if(ag==="w"){ab=c7(ae,ad,!0,!1)}else{if(ag!=="p"){return null}ab=expandParagraphUnderCursor(ae,ad,!0,!1)}}}}return ae.state.vim.visualMode?a(ae,ab.start,ab.end):[ab.start,ab.end]},repeatLastCharacterSearch:function(ae,ah,ac){var af=F.lastChararacterSearch,aa=ac.repeat,ag=ac.forward===af.forward,ad=(af.increment?1:0)*(ag?-1:1);ae.moveH(-ad,"char"),ac.inclusive=ag?!0:!1;var ab=v(ae,aa,ag,af.selectedCharacter);return ab?(ab.ch+=ad,ab):(ae.moveH(ad,"char"),ah)}},bp={change:function(ad,aa,ah){var aj,af,ak=ad.state.vim;F.macroModeState.lastInsertModeChanges.inVisualBlock=ak.visualBlock;if(!ak.visualMode){var ai=ah[0].anchor,ab=ah[0].head;af=ad.getRange(ai,ab);if(!ds(af)){var ac=/\s+$/.exec(af);ac&&(ab=a7(ab,0,-ac[0].length),af=af.slice(0,-ac[0].length))}var ae=ab.line-1==ad.lastLine();ad.replaceRange("",ai,ab),aa.linewise&&!ae&&(cq.commands.newlineAndIndent(ad),ai.ch=null),aj=ai}else{af=ad.getSelection();var ag=a8("",ah.length);ad.replaceSelections(ag),aj=cZ(ah[0].head,ah[0].anchor)}F.registerController.pushText(aa.registerName,"change",af,aa.linewise,ah.length>1),cn.enterInsertMode(ad,{head:aj},ad.state.vim)},"delete":function(ae,ab,ag){var ai,af,aa=ae.state.vim;if(!aa.visualBlock){var ah=ag[0].anchor,ac=ag[0].head;ab.linewise&&ac.line!=ae.firstLine()&&ah.line==ae.lastLine()&&ah.line==ac.line-1&&(ah.line==ae.firstLine()?ah.ch=0:ah=cm(ah.line-1,dC(ae,ah.line-1))),af=ae.getRange(ah,ac),ae.replaceRange("",ah,ac),ai=ah,ab.linewise&&(ai=dF.moveToFirstNonWhiteSpaceCharacter(ae,ah))}else{af=ae.getSelection();var ad=a8("",ag.length);ae.replaceSelections(ad),ai=ag[0].anchor}return F.registerController.pushText(ab.registerName,"delete",af,ab.linewise,aa.visualBlock),ai},indent:function(ae,ab,ag){var ai=ae.state.vim,af=ag[0].anchor.line,aa=ai.visualBlock?ag[ag.length-1].anchor.line:ag[0].head.line,ah=ai.visualMode?ab.repeat:1;ab.linewise&&aa--;for(var ac=af;ac<=aa;ac++){for(var ad=0;ad<ah;ad++){ae.indentLine(ac,ab.indentRight)}}return dF.moveToFirstNonWhiteSpaceCharacter(ae,ag[0].anchor)},changeCase:function(aa,ai,af,aj,ad){var ah=aa.getSelections(),ag=[],ak=ai.toLower;for(var al=0;al<ah.length;al++){var ab=ah[al],ae="";if(ak===!0){ae=ab.toLowerCase()}else{if(ak===!1){ae=ab.toUpperCase()}else{for(var am=0;am<ab.length;am++){var ac=ab.charAt(am);ae+=ca(ac)?ac.toLowerCase():ac.toUpperCase()}}}ag.push(ae)}return aa.replaceSelections(ag),ai.shouldMoveCursor?ad:!aa.state.vim.visualMode&&ai.linewise&&af[0].anchor.line+1==af[0].head.line?dF.moveToFirstNonWhiteSpaceCharacter(aa,aj):ai.linewise?aj:cZ(af[0].anchor,af[0].head)},yank:function(ae,aa,ac,af){var ab=ae.state.vim,ag=ae.getSelection(),ad=ab.visualMode?cZ(ab.sel.anchor,ab.sel.head,ac[0].head,ac[0].anchor):af;return F.registerController.pushText(aa.registerName,"yank",ag,aa.linewise,ab.visualBlock),ad}},cn={jumpListWalk:function(ae,ah,ac){if(ac.visualMode){return}var af=ah.repeat,aa=ah.forward,ag=F.jumpList,ad=ag.move(ae,aa?af:-af),ab=ad?ad.find():undefined;ab=ab?ab:ae.getCursor(),ae.setCursor(ab)},scroll:function(ad,aa,ah){if(ah.visualMode){return}var aj=aa.repeat||1,af=ad.defaultTextHeight(),ak=ad.getScrollInfo().top,ai=af*aj,ab=aa.forward?ak+ai:ak-ai,ac=bm(ad.getCursor()),ae=ad.charCoords(ac,"local");if(aa.forward){ab>ae.top?(ac.line+=(ab-ae.top)/af,ac.line=Math.ceil(ac.line),ad.setCursor(ac),ae=ad.charCoords(ac,"local"),ad.scrollTo(null,ae.top)):ad.scrollTo(null,ab)}else{var ag=ab+ad.getScrollInfo().clientHeight;ag<ae.bottom?(ac.line-=(ae.bottom-ag)/af,ac.line=Math.floor(ac.line),ad.setCursor(ac),ae=ad.charCoords(ac,"local"),ad.scrollTo(null,ae.bottom-ad.getScrollInfo().clientHeight)):ad.scrollTo(null,ab)}},scrollToCursor:function(ae,aa){var ac=ae.getCursor().line,af=ae.charCoords(cm(ac,0),"local"),ab=ae.getScrollInfo().clientHeight,ag=af.top,ad=af.bottom-ag;switch(aa.position){case"center":ag=ag-ab/2+ad;break;case"bottom":ag=ag-ab+ad*1.4;break;case"top":ag+=ad*0.4}ae.scrollTo(null,ag)},replayMacro:function(ad,aa,ac){var ae=aa.selectedCharacter,ab=aa.repeat,af=F.macroModeState;ae=="@"&&(ae=af.latestRegister);while(ab--){dw(ad,ac,af,ae)}},enterMacroRecordMode:function(ad,ab){var ac=F.macroModeState,aa=ab.selectedCharacter;ac.enterMacroRecordMode(ad,aa)},enterInsertMode:function(ae,aa,ac){if(ae.getOption("readOnly")){return}ac.insertMode=!0,ac.insertModeRepeat=aa&&aa.repeat||1;var af=aa?aa.insertAt:null,ab=ac.sel,ag=aa.head||ae.getCursor("head"),ad=ae.listSelections().length;if(af=="eol"){ag=cm(ag.line,dC(ae,ag.line))}else{if(af=="charAfter"){ag=a7(ag,0,1)}else{if(af=="firstNonBlank"){ag=dF.moveToFirstNonWhiteSpaceCharacter(ae,ag)}else{if(af=="startOfSelectedArea"){ac.visualBlock?(ag=cm(Math.min(ab.head.line,ab.anchor.line),Math.min(ab.head.ch,ab.anchor.ch)),ad=Math.abs(ab.head.line-ab.anchor.line)+1):ab.head.line<ab.anchor.line?ag=ab.head:ag=cm(ab.anchor.line,0)}else{if(af=="endOfSelectedArea"){ac.visualBlock?(ag=cm(Math.min(ab.head.line,ab.anchor.line),Math.max(ab.head.ch+1,ab.anchor.ch)),ad=Math.abs(ab.head.line-ab.anchor.line)+1):ab.head.line>=ab.anchor.line?ag=a7(ab.head,0,1):ag=cm(ab.anchor.line,0)}else{if(af=="inplace"&&ac.visualMode){return}}}}}}ae.setOption("keyMap","vim-insert"),ae.setOption("disableInput",!1),aa&&aa.replace?(ae.toggleOverwrite(!0),ae.setOption("keyMap","vim-replace"),cq.signal(ae,"vim-mode-change",{mode:"replace"})):(ae.setOption("keyMap","vim-insert"),cq.signal(ae,"vim-mode-change",{mode:"insert"})),F.macroModeState.isPlaying||(ae.on("change",bw),cq.on(ae.getInputField(),"keydown",bs)),ac.visualMode&&a1(ae),dy(ae,ag,ad)},toggleVisualMode:function(ad,aa,ac){var ae=aa.repeat,ab=ad.getCursor(),af;ac.visualMode?ac.visualLine^aa.linewise||ac.visualBlock^aa.blockwise?(ac.visualLine=!!aa.linewise,ac.visualBlock=!!aa.blockwise,cq.signal(ad,"vim-mode-change",{mode:"visual",subMode:ac.visualLine?"linewise":ac.visualBlock?"blockwise":""}),cU(ad)):a1(ad):(ac.visualMode=!0,ac.visualLine=!!aa.linewise,ac.visualBlock=!!aa.blockwise,af=br(ad,cm(ab.line,ab.ch+ae-1),!0),ac.sel={anchor:ab,head:af},cq.signal(ad,"vim-mode-change",{mode:"visual",subMode:ac.visualLine?"linewise":ac.visualBlock?"blockwise":""}),cU(ad),dn(ad,ac,"<",cZ(ab,af)),dn(ad,ac,">",b(ab,af)))},reselectLastSelection:function(ad,aa,ac){var ae=ac.lastSelection;ac.visualMode&&da(ad,ac);if(ae){var ab=ae.anchorMark.find(),af=ae.headMark.find();if(!ab||!af){return}ac.sel={anchor:ab,head:af},ac.visualMode=!0,ac.visualLine=ae.visualLine,ac.visualBlock=ae.visualBlock,cU(ad),dn(ad,ac,"<",cZ(ab,af)),dn(ad,ac,">",b(ab,af)),cq.signal(ad,"vim-mode-change",{mode:"visual",subMode:ac.visualLine?"linewise":ac.visualBlock?"blockwise":""})}},joinLines:function(ad,aa,ah){var aj,af;if(ah.visualMode){aj=ad.getCursor("anchor"),af=ad.getCursor("head"),af.ch=dC(ad,af.line)-1}else{var ak=Math.max(aa.repeat,2);aj=ad.getCursor(),af=br(ad,cm(aj.line+ak-1,Infinity))}var ai=0;for(var ab=aj.line;ab<af.line;ab++){ai=dC(ad,aj.line);var ac=cm(aj.line+1,dC(ad,aj.line+1)),ae=ad.getRange(aj,ac);ae=ae.replace(/\n\s*/g," "),ad.replaceRange(ae,aj,ac)}var ag=cm(aj.line,ai);ad.setCursor(ag),ah.visualMode&&a1(ad)},newLineAndEnterInsertMode:function(ad,aa,ac){ac.insertMode=!0;var ae=bm(ad.getCursor());if(ae.line===ad.firstLine()&&!aa.after){ad.replaceRange("\n",cm(ad.firstLine(),0)),ad.setCursor(ad.firstLine(),0)}else{ae.line=aa.after?ae.line:ae.line-1,ae.ch=dC(ad,ae.line),ad.setCursor(ae);var ab=cq.commands.newlineAndIndentContinueComment||cq.commands.newlineAndIndent;ab(ad)}this.enterInsertMode(ad,{repeat:aa.repeat},ac)},paste:function(ab,ar,aj){var ao=bm(ab.getCursor()),af=F.registerController.getRegister(ar.registerName),aq=af.toString();if(!aq){return}if(ar.matchIndent){var ak=ab.getOption("tabSize"),av=function(aG){var aE=aG.split("	").length-1,aF=aG.split(" ").length-1;return aE*ak+aF*1},aw=ab.getLine(ab.getCursor().line),ac=av(aw.match(/^\s*/)[0]),ah=aq.replace(/\n$/,""),aB=aq!==ah,ae=av(aq.match(/^\s*/)[0]),aq=ah.replace(/^\s*/gm,function(aE){var aF=ac+(av(aE)-ae);if(aF<0){return""}if(ab.getOption("indentWithTabs")){var aG=Math.floor(aF/ak);return Array(aG+1).join("	")}return Array(aF+1).join(" ")});aq+=aB?"\n":""}if(ar.repeat>1){var aq=Array(ar.repeat+1).join(aq)}var al=af.linewise,aa=af.blockwise;if(al){aj.visualMode?aq=aj.visualLine?aq.slice(0,-1):"\n"+aq.slice(0,aq.length-1)+"\n":ar.after?(aq="\n"+aq.slice(0,aq.length-1),ao.ch=dC(ab,ao.line)):ao.ch=0}else{if(aa){aq=aq.split("\n");for(var ax=0;ax<aq.length;ax++){aq[ax]=aq[ax]==""?" ":aq[ax]}}ao.ch+=ar.after?1:0}var ai,ad;if(aj.visualMode){aj.lastPastedText=aq;var am,az=c1(ab,aj),au=az[0],aC=az[1],aA=ab.getSelection(),aD=ab.listSelections(),ay=(new Array(aD.length)).join("1").split("1");aj.lastSelection&&(am=aj.lastSelection.headMark.find()),F.registerController.unnamedRegister.setText(aA),aa?(ab.replaceSelections(ay),aC=cm(au.line+aq.length-1,au.ch),ab.setCursor(au),bu(ab,aC),ab.replaceSelections(aq),ai=au):aj.visualBlock?(ab.replaceSelections(ay),ab.setCursor(au),ab.replaceRange(aq,au,au),ai=au):(ab.replaceRange(aq,au,aC),ai=ab.posFromIndex(ab.indexFromPos(au)+aq.length-1)),am&&(aj.lastSelection.headMark=ab.setBookmark(am)),al&&(ai.ch=0)}else{if(aa){ab.setCursor(ao);for(var ax=0;ax<aq.length;ax++){var ap=ao.line+ax;ap>ab.lastLine()&&ab.replaceRange("\n",cm(ap,0));var ag=dC(ab,ap);ag<ao.ch&&bz(ab,ap,ao.ch)}ab.setCursor(ao),bu(ab,cm(ao.line+aq.length-1,ao.ch)),ab.replaceSelections(aq),ai=ao}else{ab.replaceRange(aq,ao),al&&ar.after?ai=cm(ao.line+1,dg(ab.getLine(ao.line+1))):al&&!ar.after?ai=cm(ao.line,dg(ab.getLine(ao.line))):!al&&ar.after?(ad=ab.indexFromPos(ao),ai=ab.posFromIndex(ad+aq.length-1)):(ad=ab.indexFromPos(ao),ai=ab.posFromIndex(ad+aq.length))}}aj.visualMode&&a1(ab),ab.setCursor(ai)},undo:function(aa,ab){aa.operation(function(){S(aa,cq.commands.undo,ab.repeat)(),aa.setCursor(aa.getCursor("anchor"))})},redo:function(aa,ab){S(aa,cq.commands.redo,ab.repeat)()},setRegister:function(aa,ab,ac){ac.inputState.registerName=ab.selectedCharacter},setMark:function(ad,ab,ac){var aa=ab.selectedCharacter;dn(ad,ac,aa,ad.getCursor())},replace:function(ad,aa,ah){var aj=aa.selectedCharacter,af=ad.getCursor(),ak,ai,ab=ad.listSelections();if(ah.visualMode){af=ad.getCursor("start"),ai=ad.getCursor("end")}else{var ac=ad.getLine(af.line);ak=af.ch+aa.repeat,ak>ac.length&&(ak=ac.length),ai=cm(af.line,ak)}if(aj=="\n"){ah.visualMode||ad.replaceRange("",af,ai),(cq.commands.newlineAndIndentContinueComment||cq.commands.newlineAndIndent)(ad)}else{var ae=ad.getRange(af,ai);ae=ae.replace(/[^\n]/g,aj);if(ah.visualBlock){var ag=(new Array(ad.getOption("tabSize")+1)).join(" ");ae=ad.getSelection(),ae=ae.replace(/\t/g,ag).replace(/[^\n]/g,aj).split("\n"),ad.replaceSelections(ae)}else{ad.replaceRange(ae,af,ai)}ah.visualMode?(af=dG(ab[0].anchor,ab[0].head)?ab[0].anchor:ab[0].head,ad.setCursor(af),a1(ad)):ad.setCursor(a7(ai,0,-1))}},incrementNumberToken:function(am,ac){var af=am.getCursor(),ak=am.getLine(af.line),ad=/-?\d+/g,ab,ag,ai,aj,ao;while((ab=ad.exec(ak))!==null){ao=ab[0],ag=ab.index,ai=ag+ao.length;if(af.ch<ai){break}}if(!ac.backtrack&&ai<=af.ch){return}if(!ao){return}var ae=ac.increase?1:-1,al=parseInt(ao)+ae*ac.repeat,aa=cm(af.line,ag),ah=cm(af.line,ai);aj=al.toString(),am.replaceRange(aj,aa,ah),am.setCursor(cm(af.line,ag+aj.length-1))},repeatLastEdit:function(ad,aa,ac){var ae=ac.lastEditInputState;if(!ae){return}var ab=aa.repeat;ab&&aa.repeatIsExplicit?ac.lastEditInputState.repeatOverride=ab:ab=ac.lastEditInputState.repeatOverride||ab,ci(ad,ac,ab,!1)},exitInsertMode:bq},at={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},g={bracket:{isComplete:function(aa){if(aa.nextCh===aa.symb){aa.depth++;if(aa.depth>=1){return !0}}else{aa.nextCh===aa.reverseSymb&&aa.depth--}return !1}},section:{init:function(aa){aa.curMoveThrough=!0,aa.symb=(aa.forward?"]":"[")===aa.symb?"{":"}"},isComplete:function(aa){return aa.index===0&&aa.nextCh===aa.symb}},comment:{isComplete:function(aa){var ab=aa.lastCh==="*"&&aa.nextCh==="/";return aa.lastCh=aa.nextCh,ab}},method:{init:function(aa){aa.symb=aa.symb==="m"?"{":"}",aa.reverseSymb=aa.symb==="{"?"}":"{"},isComplete:function(aa){return aa.nextCh===aa.symb?!0:!1}},preprocess:{init:function(aa){aa.index=0},isComplete:function(aa){if(aa.nextCh==="#"){var ab=aa.lineText.match(/#(\w+)/)[1];if(ab==="endif"){if(aa.forward&&aa.depth===0){return !0}aa.depth++}else{if(ab==="if"){if(!aa.forward&&aa.depth===0){return !0}aa.depth--}}if(ab==="else"&&aa.depth===0){return !0}}return !1}}};z("pcre",!0,"boolean"),db.prototype={getQuery:function(){return F.query},setQuery:function(aa){F.query=aa},getOverlay:function(){return this.searchOverlay},setOverlay:function(aa){this.searchOverlay=aa},isReversed:function(){return F.isReversed},setReversed:function(aa){F.isReversed=aa}};var cN="(Javascript regexp)",dA=[{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"set"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}],i=function(){this.buildCommandMap_()};i.prototype={processCommand:function(ac,ak,ag){var ai=ac.state.vim,ae=F.registerController.getRegister(":"),aj=ae.toString();ai.visualMode&&a1(ac);var ah=new cq.StringStream(ak);ae.setText(ak);var al=ag||{};al.input=ak;try{this.parseInput_(ac,ah,al)}catch(aa){throw a2(ac,aa),aa}var ad,af;if(!al.commandName){al.line!==undefined&&(af="move")}else{ad=this.matchCommand_(al.commandName);if(ad){af=ad.name,ad.excludeFromCommandHistory&&ae.setText(aj),this.parseCommandArgs_(ah,al,ad);if(ad.type=="exToKey"){for(var ab=0;ab<ad.toKeys.length;ab++){cq.Vim.handleKey(ac,ad.toKeys[ab],"mapping")}return}if(ad.type=="exToEx"){this.processCommand(ac,ad.toInput);return}}}if(!af){a2(ac,'Not an editor command ":'+ak+'"');return}try{c3[af](ac,al),(!ad||!ad.possiblyAsync)&&al.callback&&al.callback()}catch(aa){throw a2(ac,aa),aa}},parseInput_:function(ad,ab,ac){ab.eatWhile(":"),ab.eat("%")?(ac.line=ad.firstLine(),ac.lineEnd=ad.lastLine()):(ac.line=this.parseLineSpec_(ad,ab),ac.line!==undefined&&ab.eat(",")&&(ac.lineEnd=this.parseLineSpec_(ad,ab)));var aa=ab.match(/^(\w+)/);return aa?ac.commandName=aa[1]:ac.commandName=ab.match(/.*/)[0],ac},parseLineSpec_:function(ad,ab){var ac=ab.match(/^(\d+)/);if(ac){return parseInt(ac[1],10)-1}switch(ab.next()){case".":return ad.getCursor().line;case"$":return ad.lastLine();case"'":var aa=ad.state.vim.marks[ab.next()];if(aa&&aa.find()){return aa.find().line}throw new Error("Mark not set");default:return ab.backUp(1),undefined}},parseCommandArgs_:function(ad,aa,ac){if(ad.eol()){return}aa.argString=ad.match(/.*/)[0];var ae=ac.argDelimiter||/\s+/,ab=c5(aa.argString).split(ae);ab.length&&ab[0]&&(aa.args=ab)},matchCommand_:function(ad){for(var ab=ad.length;ab>0;ab--){var ac=ad.substring(0,ab);if(this.commandMap_[ac]){var aa=this.commandMap_[ac];if(aa.name.indexOf(ad)===0){return aa}}}return null},buildCommandMap_:function(){this.commandMap_={};for(var aa=0;aa<dA.length;aa++){var ab=dA[aa],ac=ab.shortName||ab.name;this.commandMap_[ac]=ab}},map:function(ad,aa,ac){if(ad!=":"&&ad.charAt(0)==":"){if(ac){throw Error("Mode not supported for ex mappings")}var ae=ad.substring(1);aa!=":"&&aa.charAt(0)==":"?this.commandMap_[ae]={name:ae,type:"exToEx",toInput:aa.substring(1),user:!0}:this.commandMap_[ae]={name:ae,type:"exToKey",toKeys:aa,user:!0}}else{if(aa!=":"&&aa.charAt(0)==":"){var ab={keys:ad,type:"keyToEx",exArgs:{input:aa.substring(1)},user:!0};ac&&(ab.context=ac),V.unshift(ab)}else{var ab={keys:ad,type:"keyToKey",toKeys:aa,user:!0};ac&&(ab.context=ac),V.unshift(ab)}}},unmap:function(ad,aa){if(ad!=":"&&ad.charAt(0)==":"){if(aa){throw Error("Mode not supported for ex mappings")}var ac=ad.substring(1);if(this.commandMap_[ac]&&this.commandMap_[ac].user){delete this.commandMap_[ac];return}}else{var ae=ad;for(var ab=0;ab<V.length;ab++){if(ae==V[ab].keys&&V[ab].context===aa&&V[ab].user){V.splice(ab,1);return}}}throw Error("No such mapping.")}};var c3={map:function(ad,ab,ac){var aa=ab.args;if(!aa||aa.length<2){ad&&a2(ad,"Invalid mapping: "+ab.input);return}cb.map(aa[0],aa[1],ac)},imap:function(aa,ab){this.map(aa,ab,"insert")},nmap:function(aa,ab){this.map(aa,ab,"normal")},vmap:function(aa,ab){this.map(aa,ab,"visual")},unmap:function(ad,ab,ac){var aa=ab.args;if(!aa||aa.length<1){ad&&a2(ad,"No such mapping: "+ab.input);return}cb.unmap(aa[0],ac)},move:function(aa,ab){Y.processCommand(aa,aa.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:ab.line+1})},set:function(ae,ab){var ag=ab.args;if(!ag||ag.length<1){ae&&a2(ae,"Invalid mapping: "+ab.input);return}var ai=ag[0].split("="),af=ai[0],aa=ai[1],ah=!1;if(af.charAt(af.length-1)=="?"){if(aa){throw Error("Trailing characters: "+ab.argString)}af=af.substring(0,af.length-1),ah=!0}aa===undefined&&af.substring(0,2)=="no"&&(af=af.substring(2),aa=!1);var ac=x[af]&&x[af].type=="boolean";ac&&aa==undefined&&(aa=!0);if(!ac&&!aa||ah){var ad=t(af);ad===!0||ad===!1?a2(ae," "+(ad?"":"no")+af):a2(ae,"  "+af+"="+ad)}else{dc(af,aa,ae)}},registers:function(ae,ab){var ag=ab.args,ai=F.registerController.registers,af="----------Registers----------<br><br>";if(!ag){for(var aa in ai){var ah=ai[aa].toString();ah.length&&(af+='"'+aa+"    "+ah+"<br>")}}else{var aa;ag=ag.join("");for(var ac=0;ac<ag.length;ac++){aa=ag.charAt(ac);if(!F.registerController.isValidRegister(aa)){continue}var ad=ai[aa]||new bx;af+='"'+aa+"    "+ad.toString()+"<br>"}}a2(ae,af)},sort:function(ac,af){function am(){if(af.argString){var az=new cq.StringStream(af.argString);az.eat("!")&&(al=!0);if(az.eol()){return}if(!az.eatSpace()){return"Invalid arguments"}var ay=az.match(/[a-z]+/);if(ay){ay=ay[0],ap=ay.indexOf("i")!=-1,ai=ay.indexOf("u")!=-1;var aB=ay.indexOf("d")!=-1&&1,aC=ay.indexOf("x")!=-1&&1,aA=ay.indexOf("o")!=-1&&1;if(aB+aC+aA>1){return"Invalid arguments"}ar=aB&&"decimal"||aC&&"hex"||aA&&"octal"}az.eatSpace()&&az.match(/\/.*\//)&&"patterns not supported"}}function av(aA,aB){if(al){var aC;aC=aA,aA=aB,aB=aC}ap&&(aA=aA.toLowerCase(),aB=aB.toLowerCase());var az=ar&&ao.exec(aA),ay=ar&&ao.exec(aB);return az?(az=parseInt((az[1]+az[2]).toLowerCase(),au),ay=parseInt((ay[1]+ay[2]).toLowerCase(),au),az-ay):aA<aB?-1:1}var al,ap,ai,ar,aq=am();if(aq){a2(ac,aq+": "+af.argString);return}var aa=af.line||ac.firstLine(),ad=af.lineEnd||af.line||ac.lastLine();if(aa==ad){return}var aj=cm(aa,0),ab=cm(ad,dC(ac,ad)),ag=ac.getRange(aj,ab).split("\n"),ao=ar=="decimal"?/(-?)([\d]+)/:ar=="hex"?/(-?)(?:0x)?([0-9a-f]+)/i:ar=="octal"?/([0-7]+)/:null,au=ar=="decimal"?10:ar=="hex"?16:ar=="octal"?8:null,ak=[],ae=[];if(ar){for(var aw=0;aw<ag.length;aw++){ao.exec(ag[aw])?ak.push(ag[aw]):ae.push(ag[aw])}}else{ae=ag}ak.sort(av),ae.sort(av),ag=al?ak.concat(ae):ae.concat(ak);if(ai){var ah=ag,ax;ag=[];for(var aw=0;aw<ah.length;aw++){ah[aw]!=ax&&ag.push(ah[aw]),ax=ah[aw]}}ac.replaceRange(ag.join("\n"),aj,ab)},global:function(ak,aq){var ag=aq.argString;if(!ag){a2(ak,"Regular Expression missing from global");return}var al=aq.line!==undefined?aq.line:ak.firstLine(),ac=aq.lineEnd||aq.line||ak.lastLine(),ap=dD(ag),ah=ag,aa;ap.length&&(ah=ap[0],aa=ap.slice(1,ap.length).join("/"));if(ah){try{P(ak,ah,!0,!0)}catch(ad){a2(ak,"Invalid regex: "+ah);return}}var am=W(ak).getQuery(),af=[],ae="";for(var ao=al;ao<=ac;ao++){var ai=am.test(ak.getLine(ao));ai&&(af.push(ao+1),ae+=ak.getLine(ao)+"<br>")}if(!aa){a2(ak,ae);return}var aj=0,ab=function(){if(aj<af.length){var ar=af[aj]+aa;cb.processCommand(ak,ar,{callback:ab})}aj++};ab()},substitute:function(ah,aq){if(!ah.getSearchCursor){throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.")}var aa=aq.argString,ag=aa?dD(aa):[],al,ao="",ac,ar,ab,ai=!1,am=!1;if(ag.length){al=ag[0],ao=ag[1],ao!==undefined&&(t("pcre")?ao=bo(ao):ao=ch(ao),F.lastSubstituteReplacePart=ao),ac=ag[2]?ag[2].split(" "):[]}else{if(aa&&aa.length){a2(ah,"Substitutions should be of the form :s/pattern/replace/");return}}ac&&(ar=ac[0],ab=parseInt(ac[1]),ar&&(ar.indexOf("c")!=-1&&(ai=!0,ar.replace("c","")),ar.indexOf("g")!=-1&&(am=!0,ar.replace("g","")),al=al+"/"+ar));if(al){try{P(ah,al,!0,!0)}catch(ad){a2(ah,"Invalid regex: "+al);return}}ao=ao||F.lastSubstituteReplacePart;if(ao===undefined){a2(ah,"No previous substitute regular expression");return}var ak=W(ah),ae=ak.getQuery(),af=aq.line!==undefined?aq.line:ah.getCursor().line,au=aq.lineEnd||af;ab&&(af=au,au=af+ab-1);var ap=br(ah,cm(af,0)),aj=ah.getSearchCursor(ae,ap);dI(ah,ai,am,af,au,aj,ae,ao,aq.callback)},redo:cq.commands.redo,undo:cq.commands.undo,write:function(aa){cq.commands.save?cq.commands.save(aa):aa.save()},nohlsearch:function(aa){cW(aa)},delmarks:function(ac,ak){if(!ak.argString||!c5(ak.argString)){a2(ac,"Argument required");return}var ag=ac.state.vim,ai=new cq.StringStream(c5(ak.argString));while(!ai.eol()){ai.eatSpace();var ae=ai.pos;if(!ai.match(/[a-zA-Z]/,!1)){a2(ac,"Invalid argument: "+ak.argString.substring(ae));return}var aj=ai.next();if(ai.match("-",!0)){if(!ai.match(/[a-zA-Z]/,!1)){a2(ac,"Invalid argument: "+ak.argString.substring(ae));return}var ah=aj,al=ai.next();if(!(dp(ah)&&dp(al)||ca(ah)&&ca(al))){a2(ac,"Invalid argument: "+ah+"-");return}var aa=ah.charCodeAt(0),ad=al.charCodeAt(0);if(aa>=ad){a2(ac,"Invalid argument: "+ak.argString.substring(ae));return}for(var af=0;af<=ad-aa;af++){var ab=String.fromCharCode(aa+af);delete ag.marks[ab]}}else{delete ag.marks[aj]}}}},cb=new i;cq.keyMap.vim={attach:E,detach:l},z("insertModeEscKeysTimeout",200,"number"),cq.keyMap["vim-insert"]={"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(aa){var ab=cq.commands.newlineAndIndentContinueComment||cq.commands.newlineAndIndent;ab(aa)},fallthrough:["default"],attach:E,detach:l},cq.keyMap["await-second"]={fallthrough:["vim-insert"],attach:E,detach:l},cq.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:E,detach:l},c8(),cq.Vim=T(),T=cq.Vim,q={"return":"CR",backspace:"BS","delete":"Del",esc:"Esc",left:"Left",right:"Right",up:"Up",down:"Down",space:"Space",home:"Home",end:"End",pageup:"PageUp",pagedown:"PageDown",enter:"CR"};var cT=T.handleKey;T.handleKey=function(aa,ab,ac){return aa.operation(function(){return cT(aa,ab,ac)},!0)},M.CodeMirror=cq;var X=T.maybeInitVimState_;M.handler={$id:"ace/keyboard/vim",drawCursor:function(ae,aa,ah,aj,ak){var ai=this.state.vim||{},ab=ah.characterWidth,ac=ah.lineHeight,af=aa.top,ag=aa.left;if(!ai.insertMode){var ad=aj.cursor?cQ.comparePoints(aj.cursor,aj.start)<=0:ak.selection.isBackwards()||ak.selection.isEmpty();!ad&&ag>ab&&(ag-=ab)}!ai.insertMode&&ai.status&&(ac/=2,af+=ac),ae.left=ag+"px",ae.top=af+"px",ae.width=ab+"px",ae.height=ac+"px"},handleKeyboard:function(ad,aa,ah,aj,af){var ak=ad.editor,ai=ak.state.cm,ab=X(ai);if(aj==-1){return}if(ah=="c"&&aa==1){return !co.isMac&&ak.getCopyText()?(ak.once("copy",function(){ak.selection.clearSelection()}),{command:"null",passEvent:!0}):{command:coreCommands.stop}}ab.insertMode||co.isMac&&this.handleMacRepeat(ad,aa,ah)&&(aa=-1,ah=ad.inputChar);if(aa==-1||aa&1||aa===0&&ah.length>1){var ac=ab.insertMode,ae=dm(aa,ah,af||{});ab.status==null&&(ab.status="");var ag=cl(ai,ae,"user");ab=X(ai),ag&&ab.status!=null?ab.status+=ae:ab.status==null&&(ab.status=""),ai._signal("changeStatus");if(!ag&&(aa!=-1||ac)){return}return{command:"null",passEvent:!ag}}},attach:function(aa){aa.state||(aa.state={});var ab=new cq(aa);aa.state.cm=ab,aa.$vimModeHandler=this,cq.keyMap.vim.attach(ab),X(ab).status=null,ab.on("vim-command-done",function(){if(ab.virtualSelectionMode()){return}X(ab).status=null,ab.ace._signal("changeStatus"),ab.ace.session.markUndoGroup()}),ab.on("changeStatus",function(){ab.ace.renderer.updateCursor(),ab.ace._signal("changeStatus")}),ab.on("vim-mode-change",function(){if(ab.virtualSelectionMode()){return}ab.ace.renderer.setStyle("normal-mode",!X(ab).insertMode),ab._signal("changeStatus")}),ab.ace.renderer.setStyle("normal-mode",!X(ab).insertMode),aa.renderer.$cursorLayer.drawCursor=this.drawCursor.bind(ab),this.updateMacCompositionHandlers(aa,!0)},detach:function(aa){var ab=aa.state.cm;cq.keyMap.vim.detach(ab),ab.destroy(),aa.state.cm=null,aa.$vimModeHandler=null,aa.renderer.$cursorLayer.drawCursor=null,aa.renderer.setStyle("normal-mode",!1),this.updateMacCompositionHandlers(aa,!1)},getStatusText:function(ad){var ab=ad.state.cm,ac=X(ab);if(ac.insertMode){return"INSERT"}var aa="";return ac.visualMode&&(aa+="VISUAL",ac.visualLine&&(aa+=" LINE"),ac.visualBlock&&(aa+=" BLOCK")),ac.status&&(aa+=(aa?" ":"")+ac.status),aa},handleMacRepeat:function(aa,ab,ac){if(ab==-1){aa.inputChar=ac,aa.lastEvent="input"}else{if(aa.inputChar&&aa.$lastHash==ab&&aa.$lastKey==ac){if(aa.lastEvent=="input"){aa.lastEvent="input1"}else{if(aa.lastEvent=="input1"){return !0}}}else{aa.$lastHash=ab,aa.$lastKey=ac,aa.lastEvent="keypress"}}},updateMacCompositionHandlers:function(ad,ab){var ac=function(ag){var ae=ad.state.cm,af=X(ae);if(!af.insertMode){var ah=this.textInput.getElement();ah.blur(),ah.focus(),ah.value=ag}else{this.onCompositionUpdateOrig(ag)}},aa=function(ag){var ae=ad.state.cm,af=X(ae);af.insertMode||this.onCompositionStartOrig(ag)};ab?ad.onCompositionUpdateOrig||(ad.onCompositionUpdateOrig=ad.onCompositionUpdate,ad.onCompositionUpdate=ac,ad.onCompositionStartOrig=ad.onCompositionStart,ad.onCompositionStart=aa):ad.onCompositionUpdateOrig&&(ad.onCompositionUpdate=ad.onCompositionUpdateOrig,ad.onCompositionUpdateOrig=null,ad.onCompositionStart=ad.onCompositionStartOrig,ad.onCompositionStartOrig=null)}};var f={getText:function(aa,ab){return(Math.abs(aa.selection.lead.row-ab)||ab+1+(ab<9?"\u00b7":""))+""},getWidth:function(aa,ab,ac){return aa.getLength().toString().length*ac.characterWidth},update:function(aa,ab){ab.renderer.$loop.schedule(ab.renderer.CHANGE_GUTTER)},attach:function(aa){aa.renderer.$gutterLayer.$renderer=this,aa.on("changeSelection",this.update)},detach:function(aa){aa.renderer.$gutterLayer.$renderer=null,aa.off("changeSelection",this.update)}};T.defineOption({name:"wrap",set:function(aa,ab){ab&&ab.ace.setOption("wrap",aa)},type:"boolean"},!1),V.push({keys:"zc",type:"action",action:"fold",actionArgs:{open:!1}},{keys:"zC",type:"action",action:"fold",actionArgs:{open:!1,all:!0}},{keys:"zo",type:"action",action:"fold",actionArgs:{open:!0}},{keys:"zO",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"za",type:"action",action:"fold",actionArgs:{toggle:!0}},{keys:"zA",type:"action",action:"fold",actionArgs:{toggle:!0,all:!0}},{keys:"zf",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"zd",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"<C-A-j>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorAbove"}},{keys:"<C-A-k>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorBelow"}},{keys:"<C-A-S-j>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorAboveSkipCurrent"}},{keys:"<C-A-S-k>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorBelowSkipCurrent"}},{keys:"<C-A-h>",type:"action",action:"aceCommand",actionArgs:{name:"selectMoreBefore"}},{keys:"<C-A-l>",type:"action",action:"aceCommand",actionArgs:{name:"selectMoreAfter"}},{keys:"<C-A-S-h>",type:"action",action:"aceCommand",actionArgs:{name:"selectNextBefore"}},{keys:"<C-A-S-l>",type:"action",action:"aceCommand",actionArgs:{name:"selectNextAfter"}}),cn.aceCommand=function(aa,ab,ac){aa.vimCmd=ab,aa.ace.inVirtualSelectionMode?aa.ace.on("beforeEndOperation",di):di(null,aa.ace)},cn.fold=function(aa,ab,ac){aa.ace.execCommand(["toggleFoldWidget","toggleFoldWidget","foldOther","unfoldall"][(ab.all?2:0)+(ab.open?1:0)])},M.handler.defaultKeymap=V,T.map("Y","yy")});